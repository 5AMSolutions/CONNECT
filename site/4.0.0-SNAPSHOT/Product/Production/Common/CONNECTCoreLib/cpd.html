<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia at Oct 11, 2012
 | Rendered using Apache Maven Fluido Skin 1.3.0
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="Date-Revision-yyyymmdd" content="20121011" />
    <meta http-equiv="Content-Language" content="en" />
    <title>CONNECT Core Library - CPD Results</title>
    <link rel="stylesheet" href="./css/apache-maven-fluido-1.3.0.min.css" />
    <link rel="stylesheet" href="./css/site.css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />

      
    <script type="text/javascript" src="./js/apache-maven-fluido-1.3.0.min.js"></script>

    
            </head>
        <body class="topBarDisabled">
          
    
    
            
    
        
    <a href="http://github.com/CONNECT-Solution/CONNECT">
      <img style="position: absolute; top: 0; right: 0; border: 0; z-index: 10000;"
        src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png"
        alt="Fork me on GitHub">
    </a>
  
                
                    
    
        <div class="container-fluid">
          <div id="banner">
        <div class="pull-left">
                                    <a href="http://www.connectopensource.org/" id="bannerLeft">
                                                                                        <img src="http://www.connectopensource.org/sites/connectopensource.org/themes/connect/graphics/connect_logo.gif"  alt="CONNECT Solution"/>
                </a>
                      </div>
        <div class="pull-right">  </div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
                
            
                  <li id="publishDate">Last Published: 2012-10-11</li>
                  <li class="divider">|</li> <li id="projectVersion">Version: 4.0.0-SNAPSHOT</li>
                      
                
            
      
                            </ul>
      </div>

            
      <div class="row-fluid">
        <div id="leftColumn" class="span3">
          <div class="well sidebar-nav">
                
            
                <ul class="nav nav-list">
                              <li class="nav-header">Project Documentation</li>
                                                                                                                                                                                                                                                                                                                                              
      <li>
    
                          <a href="project-info.html" title="Project Information">
          <i class="icon-chevron-right"></i>
        Project Information</a>
                  </li>
                                                                                                                                                      
      <li>
    
                          <a href="project-reports.html" title="Project Reports">
          <i class="icon-chevron-down"></i>
        Project Reports</a>
                    <ul class="nav nav-list">
                      
      <li>
    
                          <a href="surefire-report.html" title="Surefire Report">
          <i class="none"></i>
        Surefire Report</a>
            </li>
                      
      <li>
    
                          <a href="checkstyle.html" title="Checkstyle">
          <i class="none"></i>
        Checkstyle</a>
            </li>
                      
      <li>
    
                          <a href="cobertura/index.html" title="Cobertura Test Coverage">
          <i class="none"></i>
        Cobertura Test Coverage</a>
            </li>
                      
      <li>
    
                          <a href="pmd.html" title="PMD Report">
          <i class="none"></i>
        PMD Report</a>
            </li>
                      
      <li class="active">
    
            <a href="#"><i class="none"></i>CPD Report</a>
          </li>
              </ul>
        </li>
            </ul>
                
            
                            <form id="search-form" action="http://www.google.com/search" method="get" >
    
  <input value="$sitesearchValue" name="sitesearch" type="hidden"/>
  <input class="search-query" name="q" id="query" type="text" />
</form>
<script type="text/javascript" src="http://www.google.com/coop/cse/brand?form=search-form"></script>
          
          <hr class="divider" />

           <div id="poweredBy">
                   
    <script type="text/javascript" src="https://apis.google.com/js/plusone.js"></script>

    
    <div class="g-plusone" data-href="www.connectopensource.org/Product/Production/Common/CONNECTCoreLib" data-size="tall" ></div>

                   <div class="clear"></div>
                   
        
        
        
    <iframe src="http://www.facebook.com/plugins/like.php?href=www.connectopensource.org/Product/Production/Common/CONNECTCoreLib&send=false&layout=box_count&show-faces=false&action=like&colorscheme=light"
        scrolling="no" frameborder="0"
        style="border:none; width:48px; height:63px; margin-top: 10px;" ></iframe>
               <div class="clear"></div>
               
        
        
        <div id="twitter">
    
    <a href="https://twitter.com/CONNECT_Project" class="twitter-follow-button" data-show-count="true" data-align="left" data-size="medium" data-show-screen-name="true" data-lang="en">Follow CONNECT_Project</a>
    <script type="text/javascript">!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>

        </div>
                   <div class="clear"></div>
                             <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
        <img class="builtBy" alt="Built by Maven" src="./images/logos/maven-feather.png" />
      </a>
                  </div>
          </div>
        </div>
        
                
        <div id="bodyColumn"  class="span9" >
                                  
            <div class="section"><h2>CPD Results<a name="CPD_Results"></a></h2><p>The following document contains the results of PMD's  <a class="externalLink" href="http://pmd.sourceforge.net/cpd.html">CPD</a> 4.3.</p></div><div class="section"><h2>Duplications<a name="Duplications"></a></h2><table border="0" class="table table-striped"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>gov/hhs/fha/nhinc/docrepository/DocumentProcessHelper.java</td><td>435</td></tr><tr class="a"><td>gov/hhs/fha/nhinc/docrepository/adapter/AdapterComponentDocRepositoryOrchImpl.java</td><td>619</td></tr><tr class="b"><td colspan='2'><div><pre>                            }

                            String pid3 = extractPatientInfo(documentSlots, XDS_SOURCE_PATIENT_INFO_PID3);
                            log.debug(&quot;pid3: &quot; + pid3);
                            doc.setPid3(pid3);

                            String pid5 = extractPatientInfo(documentSlots, XDS_SOURCE_PATIENT_INFO_PID5);
                            log.debug(&quot;pid5: &quot; + pid5);
                            doc.setPid5(pid5);

                            String pid7 = extractPatientInfo(documentSlots, XDS_SOURCE_PATIENT_INFO_PID7);
                            log.debug(&quot;pid7: &quot; + pid7);
                            doc.setPid7(pid7);

                            String pid8 = extractPatientInfo(documentSlots, XDS_SOURCE_PATIENT_INFO_PID8);
                            log.debug(&quot;pid8: &quot; + pid8);
                            doc.setPid8(pid8);

                            String pid11 = extractPatientInfo(documentSlots, XDS_SOURCE_PATIENT_INFO_PID11);
                            log.debug(&quot;pid11: &quot; + pid11);
                            doc.setPid11(pid11);

                            // extract classification metadata items
                            List&lt;oasis.names.tc.ebxml_regrep.xsd.rim._3.ClassificationType&gt; classifications = extrinsicObject
                                    .getClassification();

                            // extract the document's author info
                            String authorPerson = extractClassificationMetadata(classifications,
                                    XDS_AUTHOR_CLASSIFICATION, XDS_AUTHOR_PERSON_SLOT, -1);
                            log.debug(&quot;authorPerson: &quot; + authorPerson);
                            doc.setAuthorPerson(authorPerson);

                            String authorInstitution = extractClassificationMetadata(classifications,
                                    XDS_AUTHOR_CLASSIFICATION, XDS_AUTHOR_INSTITUTION_SLOT, -1);
                            log.debug(&quot;authorInstitution: &quot; + authorInstitution);
                            doc.setAuthorInstitution(authorInstitution);

                            String authorRole = extractClassificationMetadata(classifications,
                                    XDS_AUTHOR_CLASSIFICATION, XDS_AUTHOR_ROLE_SLOT, -1);
                            log.debug(&quot;authorRole: &quot; + authorRole);
                            doc.setAuthorRole(authorRole);

                            String authorSpeciality = extractClassificationMetadata(classifications,
                                    XDS_AUTHOR_CLASSIFICATION, XDS_AUTHOR_SPECIALITY_SLOT, -1);
                            log.debug(&quot;authorSpeciality: &quot; + authorSpeciality);
                            doc.setAuthorSpecialty(authorSpeciality);

                            // extract classCode
                            String classCode = extractClassificationMetadata(classifications,
                                    XDS_CLASSCODE_CLASSIFICATION, XDS_NODE_REPRESENTATION);
                            log.debug(&quot;classCode: &quot; + classCode);
                            doc.setClassCode(classCode);

                            String classCodeScheme = extractClassificationMetadata(classifications,
                                    XDS_CLASSCODE_CLASSIFICATION, XDS_CODING_SCHEME_SLOT, 0);
                            log.debug(&quot;classCodeScheme: &quot; + classCodeScheme);
                            doc.setClassCodeScheme(classCodeScheme);

                            String classCodeDisplayName = extractClassificationMetadata(classifications,
                                    XDS_CLASSCODE_CLASSIFICATION, XDS_NAME);
                            log.debug(&quot;classCodeDisplayName: &quot; + classCodeDisplayName);
                            doc.setClassCodeDisplayName(classCodeDisplayName);

                            // extract confidentialityCode
                            String confidentialityCode = extractClassificationMetadata(classifications,
                                    XDS_CONFIDENTIALITY_CODE_CLASSIFICATION, XDS_NODE_REPRESENTATION);
                            log.debug(&quot;confidentialityCode: &quot; + confidentialityCode);
                            doc.setConfidentialityCode(confidentialityCode);

                            String confidentialityCodeScheme = extractClassificationMetadata(classifications,
                                    XDS_CONFIDENTIALITY_CODE_CLASSIFICATION, XDS_CODING_SCHEME_SLOT, 0);
                            log.debug(&quot;confidentialityCodeScheme: &quot; + confidentialityCodeScheme);
                            doc.setConfidentialityCodeScheme(confidentialityCodeScheme);

                            String confidentialityCodeDisplayName = extractClassificationMetadata(classifications,
                                    XDS_CONFIDENTIALITY_CODE_CLASSIFICATION, XDS_NAME);
                            log.debug(&quot;confidentialityCodeDisplayName: &quot; + confidentialityCodeDisplayName);
                            doc.setConfidentialityCodeDisplayName(confidentialityCodeDisplayName);

                            // extract formatCode
                            String formatCode = extractClassificationMetadata(classifications,
                                    XDS_FORMAT_CODE_CLASSIFICATION, XDS_NODE_REPRESENTATION);
                            log.debug(&quot;formatCode: &quot; + formatCode);
                            doc.setFormatCode(formatCode);

                            String formatCodeScheme = extractClassificationMetadata(classifications,
                                    XDS_FORMAT_CODE_CLASSIFICATION, XDS_CODING_SCHEME_SLOT, 0);
                            log.debug(&quot;formatCodeScheme: &quot; + formatCodeScheme);
                            doc.setFormatCodeScheme(formatCodeScheme);

                            String formatCodeDisplayName = extractClassificationMetadata(classifications,
                                    XDS_FORMAT_CODE_CLASSIFICATION, XDS_NAME);
                            log.debug(&quot;formatCodeDisplayName: &quot; + formatCodeDisplayName);
                            doc.setFormatCodeDisplayName(formatCodeDisplayName);

                            // extract healthcareFacilityTypeCode
                            doc.setFacilityCode(extractClassificationMetadata(classifications,
                                    XDS_HEALTHCARE_FACILITY_TYPE_CODE_CLASSIFICATION, XDS_NODE_REPRESENTATION));
                            doc.setFacilityCodeScheme(extractClassificationMetadata(classifications,
                                    XDS_HEALTHCARE_FACILITY_TYPE_CODE_CLASSIFICATION, XDS_CODING_SCHEME_SLOT, 0));
                            doc.setFacilityCodeDisplayName(extractClassificationMetadata(classifications,
                                    XDS_HEALTHCARE_FACILITY_TYPE_CODE_CLASSIFICATION, XDS_NAME));

                            // extract practiceSettingCode
                            String practiceSetting = extractClassificationMetadata(classifications,
                                    XDS_PRACTICE_SETTING_CODE_CLASSIFICATION, XDS_NODE_REPRESENTATION);
                            log.debug(&quot;practiceSetting: &quot; + practiceSetting);
                            doc.setPracticeSetting(practiceSetting);

                            String practiceSettingScheme = extractClassificationMetadata(classifications,
                                    XDS_PRACTICE_SETTING_CODE_CLASSIFICATION, XDS_CODING_SCHEME_SLOT, 0);
                            log.debug(&quot;practiceSettingScheme: &quot; + practiceSettingScheme);
                            doc.setPracticeSettingScheme(practiceSettingScheme);

                            String practiceSettingDisplayName = extractClassificationMetadata(classifications,
                                    XDS_PRACTICE_SETTING_CODE_CLASSIFICATION, XDS_NAME);
                            log.debug(&quot;practiceSettingDisplayName: &quot; + practiceSettingDisplayName);
                            doc.setPracticeSettingDisplayName(practiceSettingDisplayName);

                            // extract typeCode
                            String typeCode = extractClassificationMetadata(classifications,
                                    XDS_TYPE_CODE_CLASSIFICATION, XDS_NODE_REPRESENTATION);
                            log.debug(&quot;typeCode: &quot; + typeCode);
                            doc.setTypeCode(typeCode);

                            String typeCodeScheme = extractClassificationMetadata(classifications,
                                    XDS_TYPE_CODE_CLASSIFICATION, XDS_CODING_SCHEME_SLOT, 0);
                            log.debug(&quot;typeCodeScheme: &quot; + typeCodeScheme);
                            doc.setTypeCodeScheme(typeCodeScheme);

                            String typeCodeDisplayName = extractClassificationMetadata(classifications,
                                    XDS_TYPE_CODE_CLASSIFICATION, XDS_NAME);
                            log.debug(&quot;typeCodeDisplayName: &quot; + typeCodeDisplayName);
                            doc.setTypeCodeDisplayName(typeCodeDisplayName);
                            // extract eventCodes
                            extractEventCodes(classifications, doc);</pre></div></td></tr></table><table border="0" class="table table-striped"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>gov/hhs/fha/nhinc/transform/subdisc/HL7AckTransforms.java</td><td>54</td></tr><tr class="a"><td>gov/hhs/fha/nhinc/transform/subdisc/HL7AckTransforms.java</td><td>180</td></tr><tr class="b"><td colspan='2'><div><pre>    public static MCCIIN000002UV01 createAckFrom201305(PRPAIN201305UV02 request, String ackMsgText) {
        MCCIIN000002UV01 ack = new MCCIIN000002UV01();
        II msgId = new II();
        String senderOID = null;
        String receiverOID = null;

        if (request != null) {
            // Extract the message id
            if (request.getId() != null) {
                msgId = request.getId();
            }

            // Set the sender OID to the receiver OID from the original message
            if (NullChecker.isNotNullish(request.getReceiver())
                    &amp;&amp; request.getReceiver().get(0) != null
                    &amp;&amp; request.getReceiver().get(0).getDevice() != null
                    &amp;&amp; request.getReceiver().get(0).getDevice().getAsAgent() != null
                    &amp;&amp; request.getReceiver().get(0).getDevice().getAsAgent().getValue() != null
                    &amp;&amp; request.getReceiver().get(0).getDevice().getAsAgent().getValue().getRepresentedOrganization() != null
                    &amp;&amp; request.getReceiver().get(0).getDevice().getAsAgent().getValue().getRepresentedOrganization()
                            .getValue() != null
                    &amp;&amp; NullChecker.isNotNullish(request.getReceiver().get(0).getDevice().getAsAgent().getValue()
                            .getRepresentedOrganization().getValue().getId())
                    &amp;&amp; request.getReceiver().get(0).getDevice().getAsAgent().getValue().getRepresentedOrganization()
                            .getValue().getId().get(0) != null
                    &amp;&amp; NullChecker.isNotNullish(request.getReceiver().get(0).getDevice().getAsAgent().getValue()
                            .getRepresentedOrganization().getValue().getId().get(0).getRoot())) {
                senderOID = request.getReceiver().get(0).getDevice().getAsAgent().getValue()
                        .getRepresentedOrganization().getValue().getId().get(0).getRoot();
            }

            // Set the receiver OID to the sender OID from the original message
            if (request.getSender() != null
                    &amp;&amp; request.getSender().getDevice() != null
                    &amp;&amp; request.getSender().getDevice().getAsAgent() != null
                    &amp;&amp; request.getSender().getDevice().getAsAgent().getValue() != null
                    &amp;&amp; request.getSender().getDevice().getAsAgent().getValue().getRepresentedOrganization() != null
                    &amp;&amp; request.getSender().getDevice().getAsAgent().getValue().getRepresentedOrganization().getValue() != null
                    &amp;&amp; NullChecker.isNotNullish(request.getSender().getDevice().getAsAgent().getValue()
                            .getRepresentedOrganization().getValue().getId())
                    &amp;&amp; request.getSender().getDevice().getAsAgent().getValue().getRepresentedOrganization().getValue()
                            .getId().get(0) != null
                    &amp;&amp; NullChecker.isNotNullish(request.getSender().getDevice().getAsAgent().getValue()
                            .getRepresentedOrganization().getValue().getId().get(0).getRoot())) {
                receiverOID = request.getSender().getDevice().getAsAgent().getValue().getRepresentedOrganization()
                        .getValue().getId().get(0).getRoot();
            }

            // Create the ack message
            ack = HL7AckTransforms.createAckMessage(null, msgId, ACK_TYPE_CODE_ACCEPT, ackMsgText, senderOID,
                    receiverOID);
        }

        return ack;
    }

    /**
     * Create acknowledgement error message from patient discovery request.
     * 
     * @param request
     * @param ackMsgText
     * @return ackMsg
     */
    public static MCCIIN000002UV01 createAckErrorFrom201305(PRPAIN201305UV02 request, String ackMsgText) {</pre></div></td></tr></table><table border="0" class="table table-striped"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>gov/hhs/fha/nhinc/transform/subdisc/HL7AckTransforms.java</td><td>117</td></tr><tr class="a"><td>gov/hhs/fha/nhinc/transform/subdisc/HL7AckTransforms.java</td><td>243</td></tr><tr class="b"><td colspan='2'><div><pre>    public static MCCIIN000002UV01 createAckErrorFrom201305(PRPAIN201305UV02 request, String ackMsgText) {
        MCCIIN000002UV01 ack = new MCCIIN000002UV01();
        II msgId = new II();
        String senderOID = null;
        String receiverOID = null;

        if (request != null) {
            // Extract the message id
            if (request.getId() != null) {
                msgId = request.getId();
            }

            // Set the sender OID to the receiver OID from the original message
            if (NullChecker.isNotNullish(request.getReceiver())
                    &amp;&amp; request.getReceiver().get(0) != null
                    &amp;&amp; request.getReceiver().get(0).getDevice() != null
                    &amp;&amp; request.getReceiver().get(0).getDevice().getAsAgent() != null
                    &amp;&amp; request.getReceiver().get(0).getDevice().getAsAgent().getValue() != null
                    &amp;&amp; request.getReceiver().get(0).getDevice().getAsAgent().getValue().getRepresentedOrganization() != null
                    &amp;&amp; request.getReceiver().get(0).getDevice().getAsAgent().getValue().getRepresentedOrganization()
                            .getValue() != null
                    &amp;&amp; NullChecker.isNotNullish(request.getReceiver().get(0).getDevice().getAsAgent().getValue()
                            .getRepresentedOrganization().getValue().getId())
                    &amp;&amp; request.getReceiver().get(0).getDevice().getAsAgent().getValue().getRepresentedOrganization()
                            .getValue().getId().get(0) != null
                    &amp;&amp; NullChecker.isNotNullish(request.getReceiver().get(0).getDevice().getAsAgent().getValue()
                            .getRepresentedOrganization().getValue().getId().get(0).getRoot())) {
                senderOID = request.getReceiver().get(0).getDevice().getAsAgent().getValue()
                        .getRepresentedOrganization().getValue().getId().get(0).getRoot();
            }

            // Set the receiver OID to the sender OID from the original message
            if (request.getSender() != null
                    &amp;&amp; request.getSender().getDevice() != null
                    &amp;&amp; request.getSender().getDevice().getAsAgent() != null
                    &amp;&amp; request.getSender().getDevice().getAsAgent().getValue() != null
                    &amp;&amp; request.getSender().getDevice().getAsAgent().getValue().getRepresentedOrganization() != null
                    &amp;&amp; request.getSender().getDevice().getAsAgent().getValue().getRepresentedOrganization().getValue() != null
                    &amp;&amp; NullChecker.isNotNullish(request.getSender().getDevice().getAsAgent().getValue()
                            .getRepresentedOrganization().getValue().getId())
                    &amp;&amp; request.getSender().getDevice().getAsAgent().getValue().getRepresentedOrganization().getValue()
                            .getId().get(0) != null
                    &amp;&amp; NullChecker.isNotNullish(request.getSender().getDevice().getAsAgent().getValue()
                            .getRepresentedOrganization().getValue().getId().get(0).getRoot())) {
                receiverOID = request.getSender().getDevice().getAsAgent().getValue().getRepresentedOrganization()
                        .getValue().getId().get(0).getRoot();
            }

            // Create the ack message
            ack = HL7AckTransforms.createAckMessage(null, msgId, ACK_TYPE_CODE_ERROR, ackMsgText, senderOID,
                    receiverOID);
        }

        return ack;
    }

    /**
     * Create acknowledgement accept message from patient discovery response.
     * 
     * @param request
     * @param ackMsgText
     * @return ackMsg
     */
    public static MCCIIN000002UV01 createAckFrom201306(PRPAIN201306UV02 request, String ackMsgText) {</pre></div></td></tr></table><table border="0" class="table table-striped"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>gov/hhs/fha/nhinc/transform/subdisc/HL7AckTransforms.java</td><td>54</td></tr><tr class="a"><td>gov/hhs/fha/nhinc/transform/subdisc/HL7AckTransforms.java</td><td>117</td></tr><tr class="b"><td colspan='2'><div><pre>    public static MCCIIN000002UV01 createAckFrom201305(PRPAIN201305UV02 request, String ackMsgText) {
        MCCIIN000002UV01 ack = new MCCIIN000002UV01();
        II msgId = new II();
        String senderOID = null;
        String receiverOID = null;

        if (request != null) {
            // Extract the message id
            if (request.getId() != null) {
                msgId = request.getId();
            }

            // Set the sender OID to the receiver OID from the original message
            if (NullChecker.isNotNullish(request.getReceiver())
                    &amp;&amp; request.getReceiver().get(0) != null
                    &amp;&amp; request.getReceiver().get(0).getDevice() != null
                    &amp;&amp; request.getReceiver().get(0).getDevice().getAsAgent() != null
                    &amp;&amp; request.getReceiver().get(0).getDevice().getAsAgent().getValue() != null
                    &amp;&amp; request.getReceiver().get(0).getDevice().getAsAgent().getValue().getRepresentedOrganization() != null
                    &amp;&amp; request.getReceiver().get(0).getDevice().getAsAgent().getValue().getRepresentedOrganization()
                            .getValue() != null
                    &amp;&amp; NullChecker.isNotNullish(request.getReceiver().get(0).getDevice().getAsAgent().getValue()
                            .getRepresentedOrganization().getValue().getId())
                    &amp;&amp; request.getReceiver().get(0).getDevice().getAsAgent().getValue().getRepresentedOrganization()
                            .getValue().getId().get(0) != null
                    &amp;&amp; NullChecker.isNotNullish(request.getReceiver().get(0).getDevice().getAsAgent().getValue()
                            .getRepresentedOrganization().getValue().getId().get(0).getRoot())) {
                senderOID = request.getReceiver().get(0).getDevice().getAsAgent().getValue()
                        .getRepresentedOrganization().getValue().getId().get(0).getRoot();
            }

            // Set the receiver OID to the sender OID from the original message
            if (request.getSender() != null
                    &amp;&amp; request.getSender().getDevice() != null
                    &amp;&amp; request.getSender().getDevice().getAsAgent() != null
                    &amp;&amp; request.getSender().getDevice().getAsAgent().getValue() != null
                    &amp;&amp; request.getSender().getDevice().getAsAgent().getValue().getRepresentedOrganization() != null
                    &amp;&amp; request.getSender().getDevice().getAsAgent().getValue().getRepresentedOrganization().getValue() != null
                    &amp;&amp; NullChecker.isNotNullish(request.getSender().getDevice().getAsAgent().getValue()
                            .getRepresentedOrganization().getValue().getId())
                    &amp;&amp; request.getSender().getDevice().getAsAgent().getValue().getRepresentedOrganization().getValue()
                            .getId().get(0) != null
                    &amp;&amp; NullChecker.isNotNullish(request.getSender().getDevice().getAsAgent().getValue()
                            .getRepresentedOrganization().getValue().getId().get(0).getRoot())) {
                receiverOID = request.getSender().getDevice().getAsAgent().getValue().getRepresentedOrganization()
                        .getValue().getId().get(0).getRoot();
            }

            // Create the ack message
            ack = HL7AckTransforms.createAckMessage(null, msgId, ACK_TYPE_CODE_ACCEPT, ackMsgText, senderOID,</pre></div></td></tr></table><table border="0" class="table table-striped"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>gov/hhs/fha/nhinc/transform/subdisc/HL7AckTransforms.java</td><td>180</td></tr><tr class="a"><td>gov/hhs/fha/nhinc/transform/subdisc/HL7AckTransforms.java</td><td>243</td></tr><tr class="b"><td colspan='2'><div><pre>    public static MCCIIN000002UV01 createAckFrom201306(PRPAIN201306UV02 request, String ackMsgText) {
        MCCIIN000002UV01 ack = new MCCIIN000002UV01();
        II msgId = new II();
        String senderOID = null;
        String receiverOID = null;

        if (request != null) {
            // Extract the message id
            if (request.getId() != null) {
                msgId = request.getId();
            }

            // Set the sender OID to the receiver OID from the original message
            if (NullChecker.isNotNullish(request.getReceiver())
                    &amp;&amp; request.getReceiver().get(0) != null
                    &amp;&amp; request.getReceiver().get(0).getDevice() != null
                    &amp;&amp; request.getReceiver().get(0).getDevice().getAsAgent() != null
                    &amp;&amp; request.getReceiver().get(0).getDevice().getAsAgent().getValue() != null
                    &amp;&amp; request.getReceiver().get(0).getDevice().getAsAgent().getValue().getRepresentedOrganization() != null
                    &amp;&amp; request.getReceiver().get(0).getDevice().getAsAgent().getValue().getRepresentedOrganization()
                            .getValue() != null
                    &amp;&amp; NullChecker.isNotNullish(request.getReceiver().get(0).getDevice().getAsAgent().getValue()
                            .getRepresentedOrganization().getValue().getId())
                    &amp;&amp; request.getReceiver().get(0).getDevice().getAsAgent().getValue().getRepresentedOrganization()
                            .getValue().getId().get(0) != null
                    &amp;&amp; NullChecker.isNotNullish(request.getReceiver().get(0).getDevice().getAsAgent().getValue()
                            .getRepresentedOrganization().getValue().getId().get(0).getRoot())) {
                senderOID = request.getReceiver().get(0).getDevice().getAsAgent().getValue()
                        .getRepresentedOrganization().getValue().getId().get(0).getRoot();
            }

            // Set the receiver OID to the sender OID from the original message
            if (request.getSender() != null
                    &amp;&amp; request.getSender().getDevice() != null
                    &amp;&amp; request.getSender().getDevice().getAsAgent() != null
                    &amp;&amp; request.getSender().getDevice().getAsAgent().getValue() != null
                    &amp;&amp; request.getSender().getDevice().getAsAgent().getValue().getRepresentedOrganization() != null
                    &amp;&amp; request.getSender().getDevice().getAsAgent().getValue().getRepresentedOrganization().getValue() != null
                    &amp;&amp; NullChecker.isNotNullish(request.getSender().getDevice().getAsAgent().getValue()
                            .getRepresentedOrganization().getValue().getId())
                    &amp;&amp; request.getSender().getDevice().getAsAgent().getValue().getRepresentedOrganization().getValue()
                            .getId().get(0) != null
                    &amp;&amp; NullChecker.isNotNullish(request.getSender().getDevice().getAsAgent().getValue()
                            .getRepresentedOrganization().getValue().getId().get(0).getRoot())) {
                receiverOID = request.getSender().getDevice().getAsAgent().getValue().getRepresentedOrganization()
                        .getValue().getId().get(0).getRoot();
            }

            // Create the ack message
            ack = HL7AckTransforms.createAckMessage(null, msgId, ACK_TYPE_CODE_ACCEPT, ackMsgText, senderOID,</pre></div></td></tr></table><table border="0" class="table table-striped"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>gov/hhs/fha/nhinc/transform/subdisc/HL7AckTransforms.java</td><td>117</td></tr><tr class="a"><td>gov/hhs/fha/nhinc/transform/subdisc/HL7AckTransforms.java</td><td>180</td></tr><tr class="b"><td colspan='2'><div><pre>    public static MCCIIN000002UV01 createAckErrorFrom201305(PRPAIN201305UV02 request, String ackMsgText) {
        MCCIIN000002UV01 ack = new MCCIIN000002UV01();
        II msgId = new II();
        String senderOID = null;
        String receiverOID = null;

        if (request != null) {
            // Extract the message id
            if (request.getId() != null) {
                msgId = request.getId();
            }

            // Set the sender OID to the receiver OID from the original message
            if (NullChecker.isNotNullish(request.getReceiver())
                    &amp;&amp; request.getReceiver().get(0) != null
                    &amp;&amp; request.getReceiver().get(0).getDevice() != null
                    &amp;&amp; request.getReceiver().get(0).getDevice().getAsAgent() != null
                    &amp;&amp; request.getReceiver().get(0).getDevice().getAsAgent().getValue() != null
                    &amp;&amp; request.getReceiver().get(0).getDevice().getAsAgent().getValue().getRepresentedOrganization() != null
                    &amp;&amp; request.getReceiver().get(0).getDevice().getAsAgent().getValue().getRepresentedOrganization()
                            .getValue() != null
                    &amp;&amp; NullChecker.isNotNullish(request.getReceiver().get(0).getDevice().getAsAgent().getValue()
                            .getRepresentedOrganization().getValue().getId())
                    &amp;&amp; request.getReceiver().get(0).getDevice().getAsAgent().getValue().getRepresentedOrganization()
                            .getValue().getId().get(0) != null
                    &amp;&amp; NullChecker.isNotNullish(request.getReceiver().get(0).getDevice().getAsAgent().getValue()
                            .getRepresentedOrganization().getValue().getId().get(0).getRoot())) {
                senderOID = request.getReceiver().get(0).getDevice().getAsAgent().getValue()
                        .getRepresentedOrganization().getValue().getId().get(0).getRoot();
            }

            // Set the receiver OID to the sender OID from the original message
            if (request.getSender() != null
                    &amp;&amp; request.getSender().getDevice() != null
                    &amp;&amp; request.getSender().getDevice().getAsAgent() != null
                    &amp;&amp; request.getSender().getDevice().getAsAgent().getValue() != null
                    &amp;&amp; request.getSender().getDevice().getAsAgent().getValue().getRepresentedOrganization() != null
                    &amp;&amp; request.getSender().getDevice().getAsAgent().getValue().getRepresentedOrganization().getValue() != null
                    &amp;&amp; NullChecker.isNotNullish(request.getSender().getDevice().getAsAgent().getValue()
                            .getRepresentedOrganization().getValue().getId())
                    &amp;&amp; request.getSender().getDevice().getAsAgent().getValue().getRepresentedOrganization().getValue()
                            .getId().get(0) != null
                    &amp;&amp; NullChecker.isNotNullish(request.getSender().getDevice().getAsAgent().getValue()
                            .getRepresentedOrganization().getValue().getId().get(0).getRoot())) {
                receiverOID = request.getSender().getDevice().getAsAgent().getValue().getRepresentedOrganization()
                        .getValue().getId().get(0).getRoot();
            }

            // Create the ack message
            ack = HL7AckTransforms.createAckMessage(null, msgId, ACK_TYPE_CODE_ERROR, ackMsgText, senderOID,</pre></div></td></tr></table><table border="0" class="table table-striped"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>gov/hhs/fha/nhinc/transform/subdisc/HL7AckTransforms.java</td><td>54</td></tr><tr class="a"><td>gov/hhs/fha/nhinc/transform/subdisc/HL7AckTransforms.java</td><td>243</td></tr><tr class="b"><td colspan='2'><div><pre>    public static MCCIIN000002UV01 createAckFrom201305(PRPAIN201305UV02 request, String ackMsgText) {
        MCCIIN000002UV01 ack = new MCCIIN000002UV01();
        II msgId = new II();
        String senderOID = null;
        String receiverOID = null;

        if (request != null) {
            // Extract the message id
            if (request.getId() != null) {
                msgId = request.getId();
            }

            // Set the sender OID to the receiver OID from the original message
            if (NullChecker.isNotNullish(request.getReceiver())
                    &amp;&amp; request.getReceiver().get(0) != null
                    &amp;&amp; request.getReceiver().get(0).getDevice() != null
                    &amp;&amp; request.getReceiver().get(0).getDevice().getAsAgent() != null
                    &amp;&amp; request.getReceiver().get(0).getDevice().getAsAgent().getValue() != null
                    &amp;&amp; request.getReceiver().get(0).getDevice().getAsAgent().getValue().getRepresentedOrganization() != null
                    &amp;&amp; request.getReceiver().get(0).getDevice().getAsAgent().getValue().getRepresentedOrganization()
                            .getValue() != null
                    &amp;&amp; NullChecker.isNotNullish(request.getReceiver().get(0).getDevice().getAsAgent().getValue()
                            .getRepresentedOrganization().getValue().getId())
                    &amp;&amp; request.getReceiver().get(0).getDevice().getAsAgent().getValue().getRepresentedOrganization()
                            .getValue().getId().get(0) != null
                    &amp;&amp; NullChecker.isNotNullish(request.getReceiver().get(0).getDevice().getAsAgent().getValue()
                            .getRepresentedOrganization().getValue().getId().get(0).getRoot())) {
                senderOID = request.getReceiver().get(0).getDevice().getAsAgent().getValue()
                        .getRepresentedOrganization().getValue().getId().get(0).getRoot();
            }

            // Set the receiver OID to the sender OID from the original message
            if (request.getSender() != null
                    &amp;&amp; request.getSender().getDevice() != null
                    &amp;&amp; request.getSender().getDevice().getAsAgent() != null
                    &amp;&amp; request.getSender().getDevice().getAsAgent().getValue() != null
                    &amp;&amp; request.getSender().getDevice().getAsAgent().getValue().getRepresentedOrganization() != null
                    &amp;&amp; request.getSender().getDevice().getAsAgent().getValue().getRepresentedOrganization().getValue() != null
                    &amp;&amp; NullChecker.isNotNullish(request.getSender().getDevice().getAsAgent().getValue()
                            .getRepresentedOrganization().getValue().getId())
                    &amp;&amp; request.getSender().getDevice().getAsAgent().getValue().getRepresentedOrganization().getValue()
                            .getId().get(0) != null
                    &amp;&amp; NullChecker.isNotNullish(request.getSender().getDevice().getAsAgent().getValue()
                            .getRepresentedOrganization().getValue().getId().get(0).getRoot())) {
                receiverOID = request.getSender().getDevice().getAsAgent().getValue().getRepresentedOrganization()
                        .getValue().getId().get(0).getRoot();
            }

            // Create the ack message
            ack = HL7AckTransforms.createAckMessage(null, msgId, ACK_TYPE_CODE_ACCEPT, ackMsgText, senderOID,</pre></div></td></tr></table><table border="0" class="table table-striped"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>gov/hhs/fha/nhinc/perfrepo/dao/PerfrepositoryDao.java</td><td>366</td></tr><tr class="a"><td>gov/hhs/fha/nhinc/perfrepo/dao/PerfrepositoryDao.java</td><td>447</td></tr><tr class="b"><td colspan='2'><div><pre>                            &quot;SELECT servicetype, messagetype, direction, AVG(duration) AS avgduration, MIN(duration) AS minduration, MAX(duration) AS maxduration, COUNT(direction) AS countval FROM perfrepo.perfrepository WHERE UPPER(direction) &lt;&gt; 'ERROR' AND starttime BETWEEN ? AND ? GROUP BY servicetype, messagetype, direction&quot;)
                    .addScalar(&quot;servicetype&quot;, Hibernate.STRING).addScalar(&quot;messagetype&quot;, Hibernate.STRING)
                    .addScalar(&quot;direction&quot;, Hibernate.STRING).addScalar(&quot;avgduration&quot;, Hibernate.DOUBLE)
                    .addScalar(&quot;minduration&quot;, Hibernate.LONG).addScalar(&quot;maxduration&quot;, Hibernate.LONG)
                    .addScalar(&quot;countval&quot;, Hibernate.LONG);

            List&lt;Object[]&gt; result = sqlQuery.setTimestamp(0, beginTime).setTimestamp(1, endTime).list();

            if (result != null &amp;&amp; result.size() &gt; 0) {
                String[] servicetypeArray = new String[result.size()];
                String[] messagetypeArray = new String[result.size()];
                String[] directionArray = new String[result.size()];
                BigDecimal[] avgdurationArray = new BigDecimal[result.size()];
                Long[] mindurationArray = new Long[result.size()];
                Long[] maxdurationArray = new Long[result.size()];
                Long[] countvalArray = new Long[result.size()];
                int counter = 0;
                for (Object[] row : result) {
                    servicetypeArray[counter] = row[0].toString();
                    messagetypeArray[counter] = row[1].toString();
                    directionArray[counter] = row[2].toString();
                    avgdurationArray[counter] = new BigDecimal(row[3].toString());
                    mindurationArray[counter] = new Long(row[4].toString());
                    maxdurationArray[counter] = new Long(row[5].toString());
                    countvalArray[counter] = new Long(row[6].toString());
                    counter++;
                }

                queryList = new ArrayList&lt;DetailDataType&gt;();
                for (int i = 0; i &lt; directionArray.length; i++) {
                    DetailDataType detailData = new DetailDataType();
                    detailData.setServiceType(servicetypeArray[i]);
                    detailData.setMessageType(messagetypeArray[i]);
                    detailData.setDirection(directionArray[i]);
                    detailData.setAvgDuration(avgdurationArray[i]);
                    detailData.setMinDuration(mindurationArray[i]);
                    detailData.setMaxDuration(maxdurationArray[i]);
                    detailData.setCount(countvalArray[i]);
                    queryList.add(detailData);
                }
            }
        } catch (Exception e) {
            log.error(&quot;Exception in getPerfrepositoryDetailRange() occured due to :&quot; + e.getMessage(), e);</pre></div></td></tr></table><table border="0" class="table table-striped"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>gov/hhs/fha/nhinc/transform/audit/NotifyTransforms.java</td><td>60</td></tr><tr class="a"><td>gov/hhs/fha/nhinc/transform/audit/NotifyTransforms.java</td><td>151</td></tr><tr class="b"><td colspan='2'><div><pre>        log.info(&quot;Entering transformNhinNotifyRequestToAuditMessage() method.&quot;);
        log.info(&quot;******************************************************************&quot;);

        // Extract UserInfo from Message.Assertion
        UserType userInfo = new UserType();
        if (message != null &amp;&amp; message.getMessage() != null &amp;&amp; message.getMessage().getAssertion() != null
                &amp;&amp; message.getMessage().getAssertion().getUserInfo() != null) {
            userInfo = message.getMessage().getAssertion().getUserInfo();
        }

        // Create EventIdentification
        CodedValueType eventID = new CodedValueType();
        eventID = AuditDataTransformHelper.createEventId(AuditDataTransformConstants.EVENT_ID_CODE_SYS_NAME_NOT,
                AuditDataTransformConstants.EVENT_ID_DISPLAY_NAME_NOTIFY,
                AuditDataTransformConstants.EVENT_ID_CODE_SYS_NAME_NOT,
                AuditDataTransformConstants.EVENT_ID_DISPLAY_NAME_NOTIFY);
        auditMsg.setEventIdentification(AuditDataTransformHelper.createEventIdentification(
                AuditDataTransformConstants.EVENT_ACTION_CODE_CREATE,
                AuditDataTransformConstants.EVENT_OUTCOME_INDICATOR_SUCCESS, eventID));

        // Create Active Participant Section
        if (userInfo != null) {
            AuditMessageType.ActiveParticipant participant = AuditDataTransformHelper.createActiveParticipantFromUser(
                    userInfo, true);
            auditMsg.getActiveParticipant().add(participant);
        }

        /* Assign AuditSourceIdentification */

        String patientId = &quot;&quot;;
        if (NullChecker.isNotNullish(message.getMessage().getAssertion().getUniquePatientId())
                &amp;&amp; NullChecker.isNotNullish(message.getMessage().getAssertion().getUniquePatientId().get(0))) {
            patientId = message.getMessage().getAssertion().getUniquePatientId().get(0);
        }

        String communityId = &quot;&quot;;
        String communityName = &quot;&quot;;
        if (userInfo != null &amp;&amp; userInfo.getOrg() != null) {

            if (userInfo.getOrg().getHomeCommunityId() != null) {
                communityId = userInfo.getOrg().getHomeCommunityId();
            }
            if (userInfo.getOrg().getName() != null) {
                communityName = userInfo.getOrg().getName();
            }
        }

        AuditSourceIdentificationType auditSource = AuditDataTransformHelper.createAuditSourceIdentification(
                communityId, communityName);
        auditMsg.getAuditSourceIdentification().add(auditSource);

        /* Assign ParticipationObjectIdentification */
        ParticipantObjectIdentificationType participantObject = AuditDataTransformHelper
                .createParticipantObjectIdentification(patientId);</pre></div></td></tr></table><table border="0" class="table table-striped"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>gov/hhs/fha/nhinc/callback/SamlConstants.java</td><td>36</td></tr><tr class="a"><td>gov/hhs/fha/nhinc/nhinclib/NhincConstants.java</td><td>150</td></tr><tr class="b"><td colspan='2'><div><pre>    public static final String ACTION_PROP = &quot;action&quot;;
    public static final String RESOURCE_PROP = &quot;resource&quot;;
    public static final String PURPOSE_CODE_PROP = &quot;purposeOfUseRoleCode&quot;;
    public static final String PURPOSE_SYST_PROP = &quot;purposeOfUseCodeSystem&quot;;
    public static final String PURPOSE_SYST_NAME_PROP = &quot;purposeOfUseCodeSystemName&quot;;
    public static final String PURPOSE_DISPLAY_PROP = &quot;purposeOfUseDisplayName&quot;;
    public static final String USER_FIRST_PROP = &quot;userFirstName&quot;;
    public static final String USER_MIDDLE_PROP = &quot;userMiddleName&quot;;
    public static final String USER_LAST_PROP = &quot;userLastName&quot;;
    public static final String USER_NAME_PROP = &quot;userName&quot;;
    public static final String USER_ORG_PROP = &quot;userOrganization&quot;;
    public static final String USER_ORG_ID_PROP = &quot;userOrganizationID&quot;;
    public static final String HOME_COM_PROP = &quot;homeCommunity&quot;;
    public static final String PATIENT_ID_PROP = &quot;patientID&quot;;
    public static final String USER_CODE_PROP = &quot;userRoleCode&quot;;
    public static final String USER_SYST_PROP = &quot;userRoleCodeSystem&quot;;
    public static final String USER_SYST_NAME_PROP = &quot;userRoleCodeSystemName&quot;;
    public static final String USER_DISPLAY_PROP = &quot;userRoleCodeDisplayName&quot;;
    public static final String AUTHN_INSTANT_PROP = &quot;authnInstant&quot;;
    public static final String AUTHN_SESSION_INDEX_PROP = &quot;authnSessionIndex&quot;;
    public static final String AUTHN_CONTEXT_CLASS_PROP = &quot;authnContextClass&quot;;
    public static final String SUBJECT_LOCALITY_ADDR_PROP = &quot;subjectLocalityAddress&quot;;
    public static final String SUBJECT_LOCALITY_DNS_PROP = &quot;subjectLocalityDNS&quot;;
    public static final String AUTHZ_DECISION_PROP = &quot;authzDecision&quot;;
    public static final String AUTHZ_STATEMENT_EXISTS_PROP = &quot;authzStatementExists&quot;;
    public static final String ASSERTION_ISSUER_PROP = &quot;assertionIssuer&quot;;
    public static final String ASSERTION_ISSUER_FORMAT_PROP = &quot;assertionIssuerFormat&quot;;
    public static final String EVIDENCE_ID_PROP = &quot;evidenceAssertionId&quot;;
    public static final String EVIDENCE_INSTANT_PROP = &quot;evidenceAssertionInstant&quot;;
    public static final String EVIDENCE_VERSION_PROP = &quot;evidenceAssertionVersion&quot;;
    public static final String EVIDENCE_ISSUER_PROP = &quot;evidenceAssertionIssuer&quot;;
    public static final String EVIDENCE_ISSUER_FORMAT_PROP = &quot;evidenceAssertionIssuerFormat&quot;;
    public static final String EVIDENCE_SUBJECT_PROP = &quot;evidenceSubject&quot;;
    public static final String EVIDENCE_CONDITION_NOT_BEFORE_PROP = &quot;evidenceConditionNotBefore&quot;;
    public static final String EVIDENCE_CONDITION_NOT_AFTER_PROP = &quot;evidenceConditionNotAfter&quot;;
    public static final String EVIDENCE_ACCESS_CONSENT_PROP = &quot;evidenceAccessConsent&quot;;
    public static final String EVIDENCE_INST_ACCESS_CONSENT_PROP = &quot;evidenceInstanceAccessConsent&quot;;
    public static final String AUDIT_QUERY_ACTION = &quot;queryAuditLog&quot;;
    public static final String NOTIFY_ACTION = &quot;notify&quot;;
    public static final String SUBSCRIBE_ACTION = &quot;subscribe&quot;;
    public static final String UNSUBSCRIBE_ACTION = &quot;unsubscribe&quot;;
    public static final String DOC_QUERY_ACTION = &quot;queryDocuments&quot;;
    public static final String DOC_RETRIEVE_ACTION = &quot;retrieveDocuments&quot;;
    public static final String PATIENT_DISCOVERY_ACTION = &quot;patientDiscovery&quot;;
    public static final String ADAPTER_XDR_ACTION = &quot;adapterXDRSecured&quot;;</pre></div></td></tr></table><table border="0" class="table table-striped"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>gov/hhs/fha/nhinc/callback/cxf/EndorsingSupportingTokensInterceptor.java</td><td>218</td></tr><tr class="a"><td>gov/hhs/fha/nhinc/callback/cxf/EndorsingSupportingTokensInterceptor.java</td><td>268</td></tr><tr class="b"><td colspan='2'><div><pre>        Collection&lt;AssertionInfo&gt; ais = aim.get(SP12Constants.ASYMMETRIC_BINDING);
        if (ais == null || ais.isEmpty()) {
            return action;
        }

        action = addToAction(action, &quot;Signature&quot;, true);
        action = addToAction(action, &quot;Encrypt&quot;, true);
        Object s = message.getContextualProperty(SecurityConstants.SIGNATURE_CRYPTO);
        if (s == null) {
            s = message.getContextualProperty(SecurityConstants.SIGNATURE_PROPERTIES);
        }
        Object e = message.getContextualProperty(SecurityConstants.ENCRYPT_CRYPTO);
        if (e == null) {
            e = message.getContextualProperty(SecurityConstants.ENCRYPT_PROPERTIES);
        }

        if (s != null) {
            URL propsURL = getPropertiesFileURL(s, message);
            String propsKey = s.toString();
            if (propsURL != null) {
                propsKey = propsURL.getPath();
            }
            message.put(WSHandlerConstants.DEC_PROP_REF_ID, &quot;RefId-&quot; + propsKey);
            if (s instanceof Crypto) {
                message.put(&quot;RefId-&quot; + propsKey, (Crypto) s);
            } else {
                message.put(&quot;RefId-&quot; + propsKey, getProps(s, propsKey, propsURL, message));
            }
            if (e == null) {
                e = s;
            }
        }
        if (e != null) {
            URL propsURL = getPropertiesFileURL(e, message);
            String propsKey = e.toString();
            if (propsURL != null) {
                propsKey = propsURL.getPath();
            }
            message.put(WSHandlerConstants.SIG_PROP_REF_ID, &quot;RefId-&quot; + propsKey);
            if (e instanceof Crypto) {
                message.put(&quot;RefId-&quot; + propsKey, (Crypto) e);
            } else {
                message.put(&quot;RefId-&quot; + propsKey, getProps(e, propsKey, propsURL, message));
            }
        }

        return action;
    }

    private String checkTransportBinding(AssertionInfoMap aim, String action, SoapMessage message) {</pre></div></td></tr></table><table border="0" class="table table-striped"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>gov/hhs/fha/nhinc/transform/policy/PatientDiscoveryPolicyTransformHelper.java</td><td>325</td></tr><tr class="a"><td>gov/hhs/fha/nhinc/transform/policy/PatientDiscoveryPolicyTransformHelper.java</td><td>348</td></tr><tr class="b"><td colspan='2'><div><pre>    protected HomeCommunityType getHomeCommunity(PRPAIN201306UV02 event) {

        HomeCommunityType senderHomeCommunity = new HomeCommunityType();

        if (event != null &amp;&amp;
                event.getSender() != null &amp;&amp;
                event.getSender().getDevice() != null &amp;&amp;
                event.getSender().getDevice().getAsAgent() != null &amp;&amp;
                event.getSender().getDevice().getAsAgent().getValue() != null &amp;&amp;
                event.getSender().getDevice().getAsAgent().getValue().getRepresentedOrganization() != null &amp;&amp;
                event.getSender().getDevice().getAsAgent().getValue().getRepresentedOrganization().getValue() != null &amp;&amp;
                NullChecker.isNotNullish(event.getSender().getDevice().getAsAgent().getValue().getRepresentedOrganization().getValue().getId()) &amp;&amp;
                event.getSender().getDevice().getAsAgent().getValue().getRepresentedOrganization().getValue().getId().get(0) != null &amp;&amp;
                NullChecker.isNotNullish(event.getSender().getDevice().getAsAgent().getValue().getRepresentedOrganization().getValue().getId().get(0).getRoot())) {

            senderHomeCommunity.setHomeCommunityId(event.getSender().getDevice().getAsAgent().getValue().getRepresentedOrganization().getValue().getId().get(0).getRoot());

        }

        return senderHomeCommunity;

    }

    protected HomeCommunityType getHomeCommunity(PRPAIN201305UV02 event) {</pre></div></td></tr></table><table border="0" class="table table-striped"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>gov/hhs/fha/nhinc/docrepository/DocumentProcessHelper.java</td><td>377</td></tr><tr class="a"><td>gov/hhs/fha/nhinc/docrepository/adapter/AdapterComponentDocRepositoryOrchImpl.java</td><td>566</td></tr><tr class="b"><td colspan='2'><div><pre>                                    + intendedRecipientValue);
                            if (intendedRecipientValue != null) {
                                String intendedRecipientPerson = &quot;&quot;;
                                String intendedRecipientOrganization = &quot;&quot;;
                                if (intendedRecipientValue.indexOf(&quot;|&quot;) != -1) {
                                    intendedRecipientValue.substring(intendedRecipientValue.indexOf(&quot;|&quot;) + 1);
                                    intendedRecipientOrganization = intendedRecipientValue.substring(0,
                                            intendedRecipientValue.indexOf(&quot;|&quot;));
                                } else {
                                    intendedRecipientOrganization = intendedRecipientValue;
                                }
                                log.debug(&quot;Document intendedRecipientPerson for ExtrinsicObject &quot; + i + &quot;: &quot;
                                        + intendedRecipientPerson);
                                log.debug(&quot;Document intendedRecipientOrganization for ExtrinsicObject &quot; + i + &quot;: &quot;
                                        + intendedRecipientOrganization);
                                doc.setIntendedRecipientPerson(intendedRecipientPerson);
                                doc.setIntendedRecipientOrganization(intendedRecipientOrganization);
                            }

                            // extract languageCode
                            doc.setLanguageCode(extractMetadataFromSlots(documentSlots, XDS_LANGUAGE_CODE_SLOT, 0));
                            log.debug(&quot;Document LanguageCode for ExtrinsicObject &quot; + i + &quot;: &quot; + doc.getLanguageCode());

                            // extract legalAuthenticator
                            doc.setLegalAuthenticator(extractMetadataFromSlots(documentSlots,
                                    XDS_LEGAL_AUTHENTICATOR_SLOT, 0));
                            log.debug(&quot;Document LegalAuthenticator for ExtrinsicObject &quot; + i + &quot;: &quot;
                                    + doc.getLegalAuthenticator());

                            // extract Date fields
                            String creationTime = extractMetadataFromSlots(documentSlots, XDS_CREATION_TIME_SLOT, 0);
                            log.debug(&quot;Document creationTime for ExtrinsicObject &quot; + i + &quot;: &quot; + creationTime);
                            // TODO add an error code for invalid date format
                            doc.setCreationTime(utcDateUtil.parseUTCDateOptionalTimeZone(creationTime));

                            String startTime = extractMetadataFromSlots(documentSlots, XDS_START_TIME_SLOT, 0);
                            log.debug(&quot;Document startTime for ExtrinsicObject &quot; + i + &quot;: &quot; + startTime);
                            doc.setServiceStartTime(utcDateUtil.parseUTCDateOptionalTimeZone(startTime));

                            String stopTime = extractMetadataFromSlots(documentSlots, XDS_STOP_TIME_SLOT, 0);
                            log.debug(&quot;Document stopTime for ExtrinsicObject &quot; + i + &quot;: &quot; + stopTime);
                            doc.setServiceStopTime(utcDateUtil.parseUTCDateOptionalTimeZone(stopTime));

                            // extract sourcePatientInfo metadata
                            String sourcePatientId = extractMetadataFromSlots(documentSlots,
                                    XDS_SOURCE_PATIENT_ID_SLOT, 0);
                            log.debug(&quot;sourcePatientid: &quot; + sourcePatientId);
                            if (sourcePatientId != null) {</pre></div></td></tr></table><table border="0" class="table table-striped"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>gov/hhs/fha/nhinc/transform/audit/UnsubscribeTransforms.java</td><td>66</td></tr><tr class="a"><td>gov/hhs/fha/nhinc/transform/audit/UnsubscribeTransforms.java</td><td>159</td></tr><tr class="b"><td colspan='2'><div><pre>        log.info(&quot;Entering transformNhinUnsubscribeRequestToAuditMessage() method.&quot;);
        log.info(&quot;******************************************************************&quot;);

        // Extract UserInfo from Message.Assertion
        UserType userInfo = new UserType();
        if (message != null &amp;&amp; message.getMessage() != null &amp;&amp; message.getMessage().getAssertion() != null
                &amp;&amp; message.getMessage().getAssertion().getUserInfo() != null) {
            userInfo = message.getMessage().getAssertion().getUserInfo();
        }

        // Create EventIdentification
        CodedValueType eventID = new CodedValueType();
        eventID = AuditDataTransformHelper.createEventId(AuditDataTransformConstants.EVENT_ID_CODE_SYS_NAME_SUB,
                AuditDataTransformConstants.EVENT_ID_DISPLAY_NAME_SUBSCRIBE,
                AuditDataTransformConstants.EVENT_ID_CODE_SYS_NAME_SUB,
                AuditDataTransformConstants.EVENT_ID_DISPLAY_NAME_SUBSCRIBE);
        auditMsg.setEventIdentification(AuditDataTransformHelper.createEventIdentification(
                AuditDataTransformConstants.EVENT_ACTION_CODE_CREATE,
                AuditDataTransformConstants.EVENT_OUTCOME_INDICATOR_SUCCESS, eventID));

        // Create Active Participant Section
        if (userInfo != null) {
            AuditMessageType.ActiveParticipant participant = AuditDataTransformHelper.createActiveParticipantFromUser(
                    userInfo, true);
            auditMsg.getActiveParticipant().add(participant);
        }

        /* Assign AuditSourceIdentification */
        String communityId = &quot;&quot;;
        String communityName = &quot;&quot;;
        String patientId = &quot;&quot;;

        // An unsubscribe message does not contain a patient identifier.

        if (userInfo != null &amp;&amp; userInfo.getOrg() != null) {
            if (userInfo.getOrg().getHomeCommunityId() != null) {
                communityId = userInfo.getOrg().getHomeCommunityId();
            }
            if (userInfo.getOrg().getName() != null) {
                communityName = userInfo.getOrg().getName();
            }
        }

        AuditSourceIdentificationType auditSource = AuditDataTransformHelper.createAuditSourceIdentification(
                communityId, communityName);
        auditMsg.getAuditSourceIdentification().add(auditSource);

        /* Assign ParticipationObjectIdentification */
        ParticipantObjectIdentificationType participantObject = AuditDataTransformHelper
                .createParticipantObjectIdentification(patientId);

        // Fill in the message field with the contents of the event message
        try {
            JAXBContextHandler oHandler = new JAXBContextHandler();
            JAXBContext jc = oHandler.getJAXBContext(&quot;org.oasis_open.docs.wsn.b_2&quot;);</pre></div></td></tr></table><table border="0" class="table table-striped"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>gov/hhs/fha/nhinc/transform/audit/XDRTransforms.java</td><td>502</td></tr><tr class="a"><td>gov/hhs/fha/nhinc/transform/policy/XDRPolicyTransformHelper.java</td><td>128</td></tr><tr class="b"><td colspan='2'><div><pre>    }

    private String getIdentifiersFromRequest(ProvideAndRegisterDocumentSetRequestType request) {
        String result = &quot;&quot;;

        if (request == null) {
            log.error((&quot;Incoming ProvideAndRegisterDocumentSetRequestType was null&quot;));
            return null;
        }

        if (request.getSubmitObjectsRequest() == null)

        {
            log.error((&quot;Incoming ProvideAndRegisterDocumentSetRequestType metadata was null&quot;));
            return null;
        }

        System.out.println(request.getSubmitObjectsRequest().getRegistryObjectList().getIdentifiable());
        RegistryObjectListType object = request.getSubmitObjectsRequest().getRegistryObjectList();

        for (int x = 0; x &lt; object.getIdentifiable().size(); x++) {
            System.out.println(object.getIdentifiable().get(x).getName());

            if (object.getIdentifiable().get(x).getDeclaredType().equals(RegistryPackageType.class)) {
                RegistryPackageType registryPackage = (RegistryPackageType) object.getIdentifiable().get(x).getValue();

                System.out.println(registryPackage.getSlot().size());

                for (int y = 0; y &lt; registryPackage.getExternalIdentifier().size(); y++) {
                    String test = registryPackage.getExternalIdentifier().get(y).getName().getLocalizedString().get(0)
                            .getValue();
                    if (test.equals(&quot;XDSSubmissionSet.patientId&quot;)) {
                        result = registryPackage.getExternalIdentifier().get(y).getValue();
                    }

                }

            }
        }

        return result;
    }</pre></div></td></tr></table><table border="0" class="table table-striped"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>gov/hhs/fha/nhinc/connectmgr/persistance/dao/InternalConnectionInfoDAOFileImpl.java</td><td>78</td></tr><tr class="a"><td>gov/hhs/fha/nhinc/connectmgr/persistance/dao/UddiConnectionInfoDAOFileImpl.java</td><td>77</td></tr><tr class="b"><td colspan='2'><div><pre>                    setFileName(sValue + File.separator + INTERNAL_XML_FILE_NAME);
                }
            }
        }

        return isFile() ? file.getAbsolutePath() : null;
    }

    private boolean isFile() {
        return file != null &amp;&amp; file.exists();
    }

    @Override
    public BusinessDetail loadBusinessDetail() throws Exception {
        if (!isFile()) {
            throw new ConnectionManagerException(&quot;Unable to access system variable: nhinc.properties.dir.&quot;);
        }

        BusinessDetail resp = null;
        try {
            resp = super.loadBusinessDetail(file);
        } catch (JAXBException ex) {
            getLogger().error(&quot;unable to load business entities from &quot; + file.getName(), ex);
            resp = new BusinessDetail();
            throw new Exception(&quot;unable to load business entities from &quot; + file.getName(), ex);
        }
        return resp;
    }

    @Override
    public void saveBusinessDetail(BusinessDetail BusinessDetail) {
        super.saveBusinessDetail(BusinessDetail, file);
    }

    public long getLastModified() {
        if (file.exists()) {
            return file.lastModified();
        } else {
            return 0;
        }
    }

    @Override
    protected Log getLogger() {
        if (log == null) {
            setLogger(LogFactory.getLog(this.getClass()));
        }
        return log;
    }

    @Override
    protected void setLogger(Log log) {
        this.log = log;
    }

    public void setFileName(String fileName) {
        file = new File(fileName);
    }
}</pre></div></td></tr></table><table border="0" class="table table-striped"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>gov/hhs/fha/nhinc/transform/audit/AdminDistTransforms.java</td><td>159</td></tr><tr class="a"><td>gov/hhs/fha/nhinc/transform/audit/AdminDistTransforms.java</td><td>245</td></tr><tr class="b"><td colspan='2'><div><pre>            communityName = target.getHomeCommunity().getName();

            /* Create the AuditSourceIdentifierType object */
            AuditSourceIdentificationType auditSource = AuditDataTransformHelper.createAuditSourceIdentification(
                    communityId, communityName);
            auditMsg.getAuditSourceIdentification().add(auditSource);

            ParticipantObjectIdentificationType participantObject = AuditDataTransformHelper
                    .createParticipantObjectIdentification(&quot;N/A&quot;);
            // Fill in the message field with the contents of the event message
            try {
                JAXBContextHandler oHandler = new JAXBContextHandler();
                JAXBContext jc = oHandler.getJAXBContext(oasis.names.tc.emergency.edxl.de._1.ObjectFactory.class,
                        oasis.names.tc.emergency.edxl.de._1.EDXLDistribution.class);
                Marshaller marshaller = jc.createMarshaller();
                ByteArrayOutputStream baOutStrm = new ByteArrayOutputStream();
                baOutStrm.reset();
                marshaller.marshal(body, baOutStrm);
                log.debug(&quot;Done marshalling the message.&quot;);

                participantObject.setParticipantObjectQuery(baOutStrm.toByteArray());

            } catch (Exception e) {
                e.printStackTrace();
                log.error(&quot;EXCEPTION when marshalling Nhin Notify Request : &quot; + e);
                throw new RuntimeException();
            }
            // Put the contents of the actual message into the Audit Log Message
            ByteArrayOutputStream baOutStrm = new ByteArrayOutputStream();

            participantObject.setParticipantObjectQuery(baOutStrm.toByteArray());
            auditMsg.getParticipantObjectIdentification().add(participantObject);

            result.setAuditMessage(auditMsg);
            result.setDirection(direction);
            result.setInterface(_interface);

            log.debug(&quot;Exiting transformEDXLDistributionRequestToAuditMsg() method.&quot;);

            return result;
        }</pre></div></td></tr></table><table border="0" class="table table-striped"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>gov/hhs/fha/nhinc/transform/audit/AdminDistTransforms.java</td><td>286</td></tr><tr class="a"><td>gov/hhs/fha/nhinc/transform/audit/XDRTransforms.java</td><td>448</td></tr><tr class="b"><td colspan='2'><div><pre>    }

    protected boolean areRequiredUserTypeFieldsNull(AssertionType oAssertion) {
        boolean bReturnVal = false;

        if ((oAssertion != null) &amp;&amp; (oAssertion.getUserInfo() != null)) {
            if (oAssertion.getUserInfo().getUserName() != null) {
                log.debug(&quot;Incomming request.getAssertion.getUserInfo.getUserName: &quot;
                        + oAssertion.getUserInfo().getUserName());
            } else {
                log.error(&quot;Incomming request.getAssertion.getUserInfo.getUserName was null.&quot;);
                bReturnVal = true;
                return true;
            }

            if (oAssertion.getUserInfo().getOrg().getHomeCommunityId() != null) {
                log.debug(&quot;Incomming request.getAssertion.getUserInfo.getOrg().getHomeCommunityId(): &quot;
                        + oAssertion.getUserInfo().getOrg().getHomeCommunityId());
            } else {
                log.error(&quot;Incomming request.getAssertion.getUserInfo.getOrg().getHomeCommunityId() was null.&quot;);
                bReturnVal = true;
                return true;
            }

            if (oAssertion.getUserInfo().getOrg().getName() != null) {
                log.debug(&quot;Incomming request.getAssertion.getUserInfo.getOrg().getName() or Community Name: &quot;
                        + oAssertion.getUserInfo().getOrg().getName());
            } else {
                log.error(&quot;Incomming request.getAssertion.getUserInfo.getOrg().getName() or Community Name was null.&quot;);
                bReturnVal = true;
                return true;
            }
        } else {
            log.error(&quot;The UserType object or request assertion object containing the assertion user info was null.&quot;);
            bReturnVal = true;
            return true;
        } // else continue

        return bReturnVal;
    }</pre></div></td></tr></table><table border="0" class="table table-striped"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>gov/hhs/fha/nhinc/policyengine/adapter/pdp/proxy/AdapterPDPProxyJavaImpl.java</td><td>197</td></tr><tr class="a"><td>gov/hhs/fha/nhinc/policyengine/adapter/pdp/proxy/AdapterPDPProxyJavaImpl.java</td><td>240</td></tr><tr class="b"><td colspan='2'><div><pre>        log.debug(&quot;Begin AdapterPDPProxyJavaImpl.getPatientIdFromPdpRequest()&quot;);
        List&lt;Resource&gt; resources = new ArrayList&lt;Resource&gt;();
        resources = (List&lt;Resource&gt;) pdpRequest.getResources();
        String attrValue = &quot;&quot;;
        if (resources != null) {
            log.debug(&quot;Resources list size:&quot; + resources.size());
            for (Resource resource : resources) {
                List&lt;Attribute&gt; attributes = new ArrayList&lt;Attribute&gt;();
                attributes = (List&lt;Attribute&gt;) resource.getAttributes();
                log.debug(&quot;Attributes list size:&quot; + attributes.size());
                for (Attribute attribute : attributes) {
                    String attrId = &quot;&quot;;
                    String attrDataType = &quot;&quot;;
                    if (attribute.getAttributeId() != null) {
                        attrId = attribute.getAttributeId().toString();
                        log.debug(&quot;AttributeId: &quot; + attrId);
                    } else {
                        log.debug(&quot;AttributeId not found in the Attribute&quot;);
                    }
                    if (attribute.getDataType() != null) {
                        attrDataType = attribute.getDataType().toString();
                        log.debug(&quot;Attribute DataType : &quot; + attrDataType);
                    } else {
                        log.debug(&quot;DataType not found in the Attribute&quot;);
                    }
                    if ((attrId.trim().equals(AdapterPDPConstants.REQUEST_CONTEXT_ATTRIBUTE_RESOURCEID))</pre></div></td></tr></table><table border="0" class="table table-striped"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>gov/hhs/fha/nhinc/transform/audit/XDRTransforms.java</td><td>234</td></tr><tr class="a"><td>gov/hhs/fha/nhinc/transform/audit/XDRTransforms.java</td><td>284</td></tr><tr class="b"><td colspan='2'><div><pre>            gov.hhs.fha.nhinc.common.nhinccommonentity.RespondingGatewayProvideAndRegisterDocumentSetSecuredResponseRequestType request,
            AssertionType assertion, String direction, String _interface) {
        LogEventRequestType result = null;
        AuditMessageType auditMsg = null;

        if (request == null) {
            log.error(&quot;Requst Object was null&quot;);
            return null;
        }
        if (assertion == null) {
            log.error(&quot;Assertion was null&quot;);
            return null;
        }

        // check to see that the required fields are not null
        boolean missingReqFields = areRequiredResponseFieldsNull(request.getRegistryResponse(), assertion);

        if (missingReqFields) {
            log.error(&quot;One or more required fields was missing&quot;);
            return null;
        }

        result = new LogEventRequestType();

        auditMsg = new AuditMessageType();
        // Create EventIdentification
        CodedValueType eventID = getCodedValueTypeForXDRResponse();

        EventIdentificationType oEventIdentificationType = getEventIdentificationType(eventID);
        auditMsg.setEventIdentification(oEventIdentificationType);

        ActiveParticipant participant = getActiveParticipant(assertion.getUserInfo());
        auditMsg.getActiveParticipant().add(participant);
        
        /* Assign ParticipationObjectIdentification */
        ParticipantObjectIdentificationType participantObject = getParticipantObjectIdentificationType(&quot;&quot;);
        auditMsg.getParticipantObjectIdentification().add(participantObject);
        
        /* Create the AuditSourceIdentifierType object */
        AuditSourceIdentificationType auditSource = getAuditSourceIdentificationType(assertion.getUserInfo());
        auditMsg.getAuditSourceIdentification().add(auditSource);

        result.setAuditMessage(auditMsg);
        result.setDirection(direction);
        result.setInterface(_interface);

        return result;
    }

    public LogEventRequestType transformRequestToAuditMsg(</pre></div></td></tr></table><table border="0" class="table table-striped"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>gov/hhs/fha/nhinc/transform/subdisc/HL7PRPA201301Transforms.java</td><td>439</td></tr><tr class="a"><td>gov/hhs/fha/nhinc/transform/subdisc/HL7PRPA201301Transforms.java</td><td>469</td></tr><tr class="b"><td colspan='2'><div><pre>    public static MFMIMT700701UV01AuthorOrPerformer copyAuthorOrPerformer(QUQIMT021001UV01AuthorOrPerformer orig) {
        MFMIMT700701UV01AuthorOrPerformer result = new MFMIMT700701UV01AuthorOrPerformer();

        result.setAssignedDevice(orig.getAssignedDevice());
        result.setAssignedPerson(orig.getAssignedPerson());
        result.setContextControlCode(orig.getContextControlCode());
        result.setModeCode(orig.getModeCode());
        result.setNoteText(orig.getNoteText());
        result.setSignatureCode(orig.getSignatureCode());
        result.setSignatureText(orig.getSignatureText());
        result.setTime(orig.getTime());
        result.setTypeCode(orig.getTypeCode());
        result.setTypeId(orig.getTypeId());

        result = HL7ArrayTransforms.copyNullFlavors(orig, result);

        if (orig.getRealmCode() != null) {
            for (CS item : orig.getRealmCode()) {
                result.getRealmCode().add(item);
            }
        }
        if (orig.getTemplateId() != null) {
            for (II item : orig.getTemplateId()) {
                result.getTemplateId().add(item);
            }
        }

        return result;
    }</pre></div></td></tr></table><table border="0" class="table table-striped"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>gov/hhs/fha/nhinc/transform/audit/DocumentRetrieveTransforms.java</td><td>94</td></tr><tr class="a"><td>gov/hhs/fha/nhinc/transform/audit/DocumentRetrieveTransforms.java</td><td>211</td></tr><tr class="b"><td colspan='2'><div><pre>                AuditDataTransformConstants.EVENT_ID_DISPLAY_NAME_DOCRETRIEVE_REQUEST);
        CodedValueType eventTypeCode = AuditDataTransformHelper.createCodeValueType(
                AuditDataTransformConstants.EVENT_TYPE_CODE_DOCRETRIEVE,
                AuditDataTransformConstants.EVENT_TYPE_CODE_SYS_NAME_DOCRETRIEVE,
                AuditDataTransformConstants.EVENT_TYPE_CODE_SYS_NAME_DOCRETRIEVE_DISPNAME,
                AuditDataTransformConstants.EVENT_TYPE_CODE_DOCRETRIEVE_DISPNAME);

        EventIdentificationType eventIdentification = AuditDataTransformHelper.createEventIdentification(
                AuditDataTransformConstants.EVENT_ACTION_CODE_READ,
                AuditDataTransformConstants.EVENT_OUTCOME_INDICATOR_SUCCESS, eventId);
        auditMsg.setEventIdentification(eventIdentification);

        eventIdentification.getEventTypeCode().add(eventTypeCode);

        // Create Active Participant Section
        if (userInfo != null) {
            AuditMessageType.ActiveParticipant participant = AuditDataTransformHelper.createActiveParticipantFromUser(
                    userInfo, true);
            auditMsg.getActiveParticipant().add(participant);
        }

        String uniquePatientId = &quot;&quot;;
        if (message != null &amp;&amp; message.getMessage() != null &amp;&amp; message.getMessage().getAssertion() != null
                &amp;&amp; message.getMessage().getAssertion().getUniquePatientId() != null
                &amp;&amp; message.getMessage().getAssertion().getUniquePatientId().size() &gt; 0) {
            uniquePatientId = message.getMessage().getAssertion().getUniquePatientId().get(0);
            log.debug(&quot;=====&gt;&gt;&gt;&gt;&gt; Create Audit Source Identification Section --&gt; Assertion Unique Patient Id is [&quot;
                    + uniquePatientId + &quot;]&quot;);
        }

        // Create Audit Source Identification Section
        AuditSourceIdentificationType auditSrcId = null;
        if (responseCommunityID != null) {</pre></div></td></tr></table><table border="0" class="table table-striped"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>gov/hhs/fha/nhinc/transform/subdisc/HL7PatientTransforms.java</td><td>526</td></tr><tr class="a"><td>gov/hhs/fha/nhinc/transform/subdisc/HL7PatientTransforms.java</td><td>541</td></tr><tr class="b"><td colspan='2'><div><pre>            CE gender, TSExplicit birthTime, List&lt;PRPAMT201301UV02OtherIDs&gt; otherIds, II remotePatId) {
        PRPAMT201302UV02OtherIDs convertedOtherIds = null;
        if (otherIds != null &amp;&amp; otherIds.size() &gt; 0 &amp;&amp; otherIds.get(0) != null &amp;&amp; otherIds.get(0).getId() != null
                &amp;&amp; otherIds.get(0).getId().size() &gt; 0 &amp;&amp; otherIds.get(0).getId().get(0) != null
                &amp;&amp; NullChecker.isNotNullish(otherIds.get(0).getId().get(0).getExtension())) {
            convertedOtherIds = createPRPAMT201302UVOtherIDs(otherIds.get(0).getId().get(0).getExtension(), remotePatId);
        } else if (remotePatId != null &amp;&amp; NullChecker.isNotNullish(remotePatId.getRoot())
                &amp;&amp; NullChecker.isNotNullish(remotePatId.getExtension())) {
            convertedOtherIds = createPRPAMT201302UVOtherIDs(null, remotePatId);
        }

        return create201302PatientPerson(patName, gender, birthTime, convertedOtherIds);
    }

    public static JAXBElement&lt;PRPAMT201302UV02PatientPatientPerson&gt; create201302PatientPerson(</pre></div></td></tr></table><table border="0" class="table table-striped"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>gov/hhs/fha/nhinc/docrepository/DocumentProcessHelper.java</td><td>348</td></tr><tr class="a"><td>gov/hhs/fha/nhinc/docrepository/adapter/AdapterComponentDocRepositoryOrchImpl.java</td><td>540</td></tr><tr class="b"><td colspan='2'><div><pre>                            InternationalStringType docTitle = extrinsicObject.getName();
                            if (docTitle != null) {
                                log.debug(&quot;DocumentTitle for ExtrinsicObject &quot; + i + &quot;: &quot;
                                        + docTitle.getLocalizedString().get(0).getValue());
                                doc.setDocumentTitle(docTitle.getLocalizedString().get(0).getValue());
                            }

                            // extract the document comments
                            InternationalStringType docComments = extrinsicObject.getDescription();
                            if (docComments != null) {
                                log.debug(&quot;DocumentComments for ExtrinsicObject &quot; + i + &quot;: &quot;
                                        + docComments.getLocalizedString().get(0).getValue());
                                doc.setComments(docComments.getLocalizedString().get(0).getValue());
                            }

                            // extract mimeType
                            log.debug(&quot;Document mimeType for ExtrinsicObject &quot; + i + &quot;: &quot;
                                    + extrinsicObject.getMimeType());
                            doc.setMimeType(extrinsicObject.getMimeType());

                            // there are many metadata items at the extrinsicObject/document
                            // level that we need to translate to the NHINC format
                            List&lt;oasis.names.tc.ebxml_regrep.xsd.rim._3.SlotType1&gt; documentSlots = extrinsicObject
                                    .getSlot();

                            // extract intendedRecipient - format: organization|person
                            String intendedRecipientValue = extractMetadataFromSlots(documentSlots,
                                    XDS_INTENDED_RECIPIENT_SLOT, 0);</pre></div></td></tr></table><table border="0" class="table table-striped"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>gov/hhs/fha/nhinc/docrepository/DocumentProcessHelper.java</td><td>693</td></tr><tr class="a"><td>gov/hhs/fha/nhinc/docrepository/adapter/AdapterComponentDocRepositoryOrchImpl.java</td><td>1010</td></tr><tr class="b"><td colspan='2'><div><pre>        for (ClassificationType classification : classifications) {
            String classificationSchemeName = classification.getClassificationScheme();
            log.debug(&quot;Found classificationScheme=&quot; + classificationSchemeName);

            if (classificationSchemeUUID.equals(classificationSchemeName)) {
                if (classificationValueName.equals(XDS_NAME)) {
                    classificationValue = classification.getName().getLocalizedString().get(0).getValue();
                } else if (classificationValueName.equals(XDS_NODE_REPRESENTATION)) {
                    classificationValue = classification.getNodeRepresentation();
                } else if (classificationValueName.equals(XDS_CLASSIFIED_OBJECT)) {
                    classificationValue = classification.getClassifiedObject();
                } else if (classificationValueName.equals(XDS_CLASSIFICATION_ID)) {
                    classificationValue = classification.getClassifiedObject();
                }
                break; // found desired classification, have values, exit loop
            } // if (classificationSchemeUUID.equals(classificationSchemeName))
        }
        if (classificationValue != null &amp;&amp; !classificationValue.equals(&quot;&quot;)) {
            classificationValue = StringUtil.extractStringFromTokens(classificationValue, &quot;'()&quot;);
        }
        log.debug(classificationValueName + &quot;: &quot; + classificationValue);
        return classificationValue;
    }

    /**
     * Extracts the valueIndex value from an XDS request slot for a given metadata name.
     * 
     * @param documentSlots A list of XDS metadata slots
     * @param slotName The name of the slot containing the desired metadata item
     * @param valueIndex For slot multivalued possibilities, the index value desired. If the value is &lt; 0 then all
     *            values in the value list are returned in a '~' delimited list.
     * @return Returns the value of the first metadata value with the given metadata name. Null if not present.
     */
    private String extractMetadataFromSlots(List&lt;SlotType1&gt; documentSlots, String slotName, int valueIndex) {</pre></div></td></tr></table><table border="0" class="table table-striped"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>gov/hhs/fha/nhinc/transform/audit/SubscribeTransforms.java</td><td>70</td></tr><tr class="a"><td>gov/hhs/fha/nhinc/transform/audit/UnsubscribeTransforms.java</td><td>66</td></tr><tr class="b"><td>gov/hhs/fha/nhinc/transform/audit/UnsubscribeTransforms.java</td><td>159</td></tr><tr class="a"><td colspan='2'><div><pre>        log.info(&quot;Entering transformNhinSubscribeRequestToAuditMessage() method.&quot;);
        log.info(&quot;******************************************************************&quot;);

        // Extract UserInfo from Message.Assertion
        UserType userInfo = new UserType();
        if (message != null &amp;&amp; message.getMessage() != null &amp;&amp; message.getMessage().getAssertion() != null
                &amp;&amp; message.getMessage().getAssertion().getUserInfo() != null) {
            userInfo = message.getMessage().getAssertion().getUserInfo();
        }

        // Create EventIdentification
        CodedValueType eventID = new CodedValueType();
        eventID = AuditDataTransformHelper.createEventId(AuditDataTransformConstants.EVENT_ID_CODE_SYS_NAME_SUB,
                AuditDataTransformConstants.EVENT_ID_DISPLAY_NAME_SUBSCRIBE,
                AuditDataTransformConstants.EVENT_ID_CODE_SYS_NAME_SUB,
                AuditDataTransformConstants.EVENT_ID_DISPLAY_NAME_SUBSCRIBE);
        auditMsg.setEventIdentification(AuditDataTransformHelper.createEventIdentification(
                AuditDataTransformConstants.EVENT_ACTION_CODE_CREATE,
                AuditDataTransformConstants.EVENT_OUTCOME_INDICATOR_SUCCESS, eventID));

        // Create Active Participant Section
        if (userInfo != null) {
            AuditMessageType.ActiveParticipant participant = AuditDataTransformHelper.createActiveParticipantFromUser(
                    userInfo, true);
            auditMsg.getActiveParticipant().add(participant);
        }

        /* Assign AuditSourceIdentification */
        String communityId = &quot;&quot;;
        String communityName = &quot;&quot;;
        String patientId = &quot;&quot;;

        if ((message != null) &amp;&amp; (message.getMessage() != null) &amp;&amp; (message.getMessage().getSubscribe() != null)) {</pre></div></td></tr></table><table border="0" class="table table-striped"><tr class="b"><th>File</th><th>Line</th></tr><tr class="a"><td>gov/hhs/fha/nhinc/transform/subdisc/HL7PatientTransforms.java</td><td>159</td></tr><tr class="b"><td>gov/hhs/fha/nhinc/transform/subdisc/HL7PatientTransforms.java</td><td>192</td></tr><tr class="a"><td colspan='2'><div><pre>    public static PRPAMT201301UV02Patient createPRPAMT201301UVPatient(PRPAMT201310UV02Patient patient) {
        PRPAMT201301UV02Patient result = new PRPAMT201301UV02Patient();

        if (patient == null) {
            return null;
        }

        result.setEffectiveTime(patient.getEffectiveTime());
        if (patient.getProviderOrganization() != null) {
            result.setProviderOrganization(patient.getProviderOrganization().getValue());
        }

        result.setStatusCode(patient.getStatusCode());
        result.setTypeId(patient.getTypeId());
        result.setVeryImportantPersonCode(patient.getVeryImportantPersonCode());

        for (ADExplicit address : patient.getAddr()) {
            result.getAddr().add(address);
        }
        for (TELExplicit telephone : patient.getTelecom()) {
            result.getTelecom().add(telephone);
        }

        for (CE code : patient.getConfidentialityCode()) {
            result.getConfidentialityCode().add(code);
        }

        result.setPatientPerson(create201301PatientPerson(patient.getPatientPerson().getValue()));</pre></div></td></tr></table><table border="0" class="table table-striped"><tr class="b"><th>File</th><th>Line</th></tr><tr class="a"><td>gov/hhs/fha/nhinc/docrepository/DocumentProcessHelper.java</td><td>632</td></tr><tr class="b"><td>gov/hhs/fha/nhinc/docrepository/adapter/AdapterComponentDocRepositoryOrchImpl.java</td><td>948</td></tr><tr class="a"><td colspan='2'><div><pre>        for (ExternalIdentifierType externalIdentifier : externalIdentifiers) {
            String externalIdentifierName = externalIdentifier.getName().getLocalizedString().get(0).getValue();
            log.debug(&quot;externalIdentifierName: &quot; + externalIdentifierName);
            if (metadataItemName.equalsIgnoreCase(externalIdentifierName)) {
                metadataItemValue = externalIdentifier.getValue();
                break;
            }
        }

        return metadataItemValue;
    }

    /**
     * This method extracts metadata from the XDS classification element given the slotname of the metadata item.
     * 
     * @param classifications A list of classifications to search through.
     * @param classificationSchemeUUID The classification scheme idendifier to search for.
     * @param slotName The name of the metadata item within the classification element.
     * @param valueIndex In case there are multiple values for the metadata item, the option to choose a single value or
     *            all values (i.e. -1).
     * @return Returns the value of the metadata item found in the XDS classification element given the slotname.
     */
    private String extractClassificationMetadata(
            List&lt;oasis.names.tc.ebxml_regrep.xsd.rim._3.ClassificationType&gt; classifications,
            String classificationSchemeUUID, String slotName, int valueIndex) {
        String classificationValue = null;

        // loop through the classifications looking for the desired classification uuid
        for (oasis.names.tc.ebxml_regrep.xsd.rim._3.ClassificationType classification : classifications) {
            String classificationSchemeName = classification.getClassificationScheme();
            if (classificationSchemeUUID.equals(classificationSchemeName)) {
                classificationValue = extractMetadataFromSlots(classification.getSlot(), slotName, valueIndex);
                break;
            }
        }

        return classificationValue;
    }

    /**
     * This method extracts classification element metadata for non-slot values given the classification code uuid. The
     * following will be retrieved depending on the value of the classificationValueName: - the classification code
     * value (nodeRepresentation) - the representation of the code (nodeRepresentationName) - the id of the
     * extrinsicObject referenced by the given classification (classificationObject) - the id of the
     * classificationObject element in the request (id)
     * 
     * @param classifications A list of classifications to search through.
     * @param classificationSchemeUUID The classification scheme idendifier to search for.
     * @param classificationValueName A string value indicating whether this method should return the classification
     *            code representation, the code itself, the id of the classification element, or the id of the
     *            extrinsicObject element that the classification refers to.
     * @return Returns the value of the metadata item found in the XDS classification element given the classification
     *         scheme and the name of the desired metadata element.
     */
    private String extractClassificationMetadata(List&lt;ClassificationType&gt; classifications,</pre></div></td></tr></table><table border="0" class="table table-striped"><tr class="b"><th>File</th><th>Line</th></tr><tr class="a"><td>gov/hhs/fha/nhinc/transform/audit/SubscribeTransforms.java</td><td>70</td></tr><tr class="b"><td>gov/hhs/fha/nhinc/transform/audit/SubscribeTransforms.java</td><td>165</td></tr><tr class="a"><td>gov/hhs/fha/nhinc/transform/audit/UnsubscribeTransforms.java</td><td>66</td></tr><tr class="b"><td>gov/hhs/fha/nhinc/transform/audit/UnsubscribeTransforms.java</td><td>159</td></tr><tr class="a"><td colspan='2'><div><pre>        log.info(&quot;Entering transformNhinSubscribeRequestToAuditMessage() method.&quot;);
        log.info(&quot;******************************************************************&quot;);

        // Extract UserInfo from Message.Assertion
        UserType userInfo = new UserType();
        if (message != null &amp;&amp; message.getMessage() != null &amp;&amp; message.getMessage().getAssertion() != null
                &amp;&amp; message.getMessage().getAssertion().getUserInfo() != null) {
            userInfo = message.getMessage().getAssertion().getUserInfo();
        }

        // Create EventIdentification
        CodedValueType eventID = new CodedValueType();
        eventID = AuditDataTransformHelper.createEventId(AuditDataTransformConstants.EVENT_ID_CODE_SYS_NAME_SUB,
                AuditDataTransformConstants.EVENT_ID_DISPLAY_NAME_SUBSCRIBE,
                AuditDataTransformConstants.EVENT_ID_CODE_SYS_NAME_SUB,
                AuditDataTransformConstants.EVENT_ID_DISPLAY_NAME_SUBSCRIBE);
        auditMsg.setEventIdentification(AuditDataTransformHelper.createEventIdentification(
                AuditDataTransformConstants.EVENT_ACTION_CODE_CREATE,
                AuditDataTransformConstants.EVENT_OUTCOME_INDICATOR_SUCCESS, eventID));

        // Create Active Participant Section
        if (userInfo != null) {
            AuditMessageType.ActiveParticipant participant = AuditDataTransformHelper.createActiveParticipantFromUser(
                    userInfo, true);
            auditMsg.getActiveParticipant().add(participant);
        }

        /* Assign AuditSourceIdentification */
        String communityId = &quot;&quot;;
        String communityName = &quot;&quot;;</pre></div></td></tr></table><table border="0" class="table table-striped"><tr class="b"><th>File</th><th>Line</th></tr><tr class="a"><td>gov/hhs/fha/nhinc/docrepository/DocumentProcessHelper.java</td><td>741</td></tr><tr class="b"><td>gov/hhs/fha/nhinc/docrepository/adapter/AdapterComponentDocRepositoryOrchImpl.java</td><td>1059</td></tr><tr class="a"><td colspan='2'><div><pre>                    Iterator iter = slot.getValueList().getValue().iterator();
                    while (iter.hasNext()) {
                        String value = (String) iter.next();
                        slotValues.append(value);
                        counter++;
                        if (counter &lt; listSize) {
                            slotValues.append(VALUE_LIST_SEPERATOR);
                        }
                    }

                } else {
                    if (slot.getValueList() != null &amp;&amp; slot.getValueList().getValue() != null
                            &amp;&amp; slot.getValueList().getValue().size() &gt; 0) {
                        slotValue = slot.getValueList().getValue().get(valueIndex);
                    } else {
                        slotValue = &quot;&quot;;
                    }
                }
                break; // found desired slot, have values, exit loop
            } // if (slotName.equals(slot.getName()))
        } // for (oasis.names.tc.ebxml_regrep.xsd.rim._3.SlotType1 slot : documentSlots)
        if (returnAllValues) {
            slotValue = slotValues.toString();
        }

        log.debug(slotName + &quot;: &quot; + slotValue);
        return slotValue;
    }

    /**
     * Extracts the sourcePatientInfo pid value from an XDS request slot for the sourcePatientInfo element.
     * 
     * @param documentSlots A list of XDS metadata slots
     * @param patientInfoName The name of the sourcePatientInfo pid containing the desired metadata item
     * @return Returns the value of the first metadata value with the given metadata name. Null if not present.
     */
    private String extractPatientInfo(List&lt;SlotType1&gt; documentSlots, String patientInfoName) {</pre></div></td></tr></table><table border="0" class="table table-striped"><tr class="b"><th>File</th><th>Line</th></tr><tr class="a"><td>gov/hhs/fha/nhinc/transform/policy/AdhocQueryTransformHelper.java</td><td>115</td></tr><tr class="b"><td>gov/hhs/fha/nhinc/transform/policy/AdhocQueryTransformHelper.java</td><td>190</td></tr><tr class="a"><td colspan='2'><div><pre>        log.debug(&quot;transformAdhocQueryResponseToCheckPolicyBase PatientId: &quot; + sStrippedPatientId);

        resource.getAttribute().add(
                attrHelper.attributeFactory(PatientAssigningAuthorityAttributeId, Constants.DataTypeString, aaId));

        resource.getAttribute().add(
                attrHelper.attributeFactory(PatientIdAttributeId, Constants.DataTypeString, sStrippedPatientId));
        request.getResource().add(resource);

        SubjectHelper subjHelp = new SubjectHelper();
        SubjectType subject = subjHelp.subjectFactory(event.getSendingHomeCommunity(), event.getMessage()
                .getAssertion());
        request.getSubject().add(subject);

        AssertionHelper assertHelp = new AssertionHelper();
        assertHelp.appendAssertionDataToRequest(request, event.getMessage().getAssertion());

        CheckPolicyRequestType policyRequest = new CheckPolicyRequestType();
        policyRequest.setRequest(request);
        genericPolicyRequest.setRequest(request);
        genericPolicyRequest.setAssertion(event.getMessage().getAssertion());
        return genericPolicyRequest;
    }

    private static CheckPolicyRequestType transformAdhocQueryResponseInboundToCheckPolicy(</pre></div></td></tr></table><table border="0" class="table table-striped"><tr class="b"><th>File</th><th>Line</th></tr><tr class="a"><td>gov/hhs/fha/nhinc/transform/policy/PatientDiscoveryPolicyTransformHelper.java</td><td>412</td></tr><tr class="b"><td>gov/hhs/fha/nhinc/transform/policy/PatientDiscoveryPolicyTransformHelper.java</td><td>453</td></tr><tr class="a"><td colspan='2'><div><pre>    protected RequestType getRequestType(PRPAIN201306UV02 event, AssertionType assertion) {

        addDebugLog(&quot;Begin -- PatientDiscoveryPolicyTransformHelper.getRequestType()&quot;);

        RequestType request = new RequestType();

        setSubjectToRequestType(event, request, assertion);

        ResourceType resource = null;

        AttributeHelper attrHelper = new AttributeHelper();

        II ii = extractPatientIdentifier(event);

        if (ii != null) {

            resource = new ResourceType();

            resource.getAttribute().add(
                    attrHelper.attributeFactory(PatientAssigningAuthorityAttributeId, Constants.DataTypeString,
                    ii.getRoot()));

            String sStrippedPatientId = PatientIdFormatUtil.parsePatientId(ii.getExtension());

            log.debug(&quot;transformSubjectAddedInToCheckPolicy: sStrippedPatientId = &quot; + sStrippedPatientId);

            resource.getAttribute().add(
                    attrHelper.attributeFactory(PatientIdAttributeId, Constants.DataTypeString, sStrippedPatientId));

            request.getResource().add(resource);

        }

        request.getResource().add(resource);

        addDebugLog(&quot;End -- PatientDiscoveryPolicyTransformHelper.getRequestType()&quot;);

        return request;

    }

    protected RequestType getRequestType(PRPAIN201305UV02 event, AssertionType assertion) {</pre></div></td></tr></table><table border="0" class="table table-striped"><tr class="b"><th>File</th><th>Line</th></tr><tr class="a"><td>gov/hhs/fha/nhinc/transform/audit/NotifyTransforms.java</td><td>97</td></tr><tr class="b"><td>gov/hhs/fha/nhinc/transform/audit/SubscribeTransforms.java</td><td>112</td></tr><tr class="a"><td colspan='2'><div><pre>        if (userInfo != null &amp;&amp; userInfo.getOrg() != null) {

            if (userInfo.getOrg().getHomeCommunityId() != null) {
                communityId = userInfo.getOrg().getHomeCommunityId();
            }
            if (userInfo.getOrg().getName() != null) {
                communityName = userInfo.getOrg().getName();
            }
        }

        AuditSourceIdentificationType auditSource = AuditDataTransformHelper.createAuditSourceIdentification(
                communityId, communityName);
        auditMsg.getAuditSourceIdentification().add(auditSource);

        /* Assign ParticipationObjectIdentification */
        ParticipantObjectIdentificationType participantObject = AuditDataTransformHelper
                .createParticipantObjectIdentification(patientId);

        // Fill in the message field with the contents of the event message
        try {
            JAXBContextHandler oHandler = new JAXBContextHandler();
            JAXBContext jc = oHandler.getJAXBContext(org.oasis_open.docs.wsn.b_2.ObjectFactory.class,</pre></div></td></tr></table><table border="0" class="table table-striped"><tr class="b"><th>File</th><th>Line</th></tr><tr class="a"><td>gov/hhs/fha/nhinc/docregistry/adapter/AdapterComponentDocRegistryOrchImpl.java</td><td>1100</td></tr><tr class="b"><td>gov/hhs/fha/nhinc/util/format/DocumentClassCodeParser.java</td><td>59</td></tr><tr class="a"><td colspan='2'><div><pre>        if ((paramFormattedString != null) &amp;&amp; (resultCollection != null)) {
            if (paramFormattedString.startsWith(&quot;(&quot;)) {
                String working = paramFormattedString.substring(1);
                int endIndex = working.indexOf(&quot;)&quot;);
                if (endIndex != -1) {
                    working = working.substring(0, endIndex);
                }
                String[] multiValueString = working.split(&quot;,&quot;);
                if (multiValueString != null) {
                    for (int i = 0; i &lt; multiValueString.length; i++) {
                        String singleValue = multiValueString[i];
                        if (singleValue != null) {
                            singleValue = singleValue.trim();
                        }
                        if (singleValue.startsWith(&quot;'&quot;)) {
                            singleValue = singleValue.substring(1);</pre></div></td></tr></table><table border="0" class="table table-striped"><tr class="b"><th>File</th><th>Line</th></tr><tr class="a"><td>gov/hhs/fha/nhinc/transform/audit/XDRTransforms.java</td><td>249</td></tr><tr class="b"><td>gov/hhs/fha/nhinc/transform/audit/XDRTransforms.java</td><td>299</td></tr><tr class="a"><td>gov/hhs/fha/nhinc/transform/audit/XDRTransforms.java</td><td>348</td></tr><tr class="b"><td colspan='2'><div><pre>        boolean missingReqFields = areRequiredResponseFieldsNull(request.getRegistryResponse(), assertion);

        if (missingReqFields) {
            log.error(&quot;One or more required fields was missing&quot;);
            return null;
        }

        result = new LogEventRequestType();

        auditMsg = new AuditMessageType();
        // Create EventIdentification
        CodedValueType eventID = getCodedValueTypeForXDRResponse();

        EventIdentificationType oEventIdentificationType = getEventIdentificationType(eventID);
        auditMsg.setEventIdentification(oEventIdentificationType);

        ActiveParticipant participant = getActiveParticipant(assertion.getUserInfo());
        auditMsg.getActiveParticipant().add(participant);
        
        /* Assign ParticipationObjectIdentification */
        ParticipantObjectIdentificationType participantObject = getParticipantObjectIdentificationType(&quot;&quot;);
        auditMsg.getParticipantObjectIdentification().add(participantObject);
        
        /* Create the AuditSourceIdentifierType object */
        AuditSourceIdentificationType auditSource = getAuditSourceIdentificationType(assertion.getUserInfo());
        auditMsg.getAuditSourceIdentification().add(auditSource);

        result.setAuditMessage(auditMsg);
        result.setDirection(direction);
        result.setInterface(_interface);

        return result;
    }</pre></div></td></tr></table><table border="0" class="table table-striped"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>gov/hhs/fha/nhinc/docrepository/adapter/model/EventCode.java</td><td>113</td></tr><tr class="a"><td>gov/hhs/fha/nhinc/docrepository/adapter/model/EventCodeParam.java</td><td>78</td></tr><tr class="b"><td colspan='2'><div><pre>        if ((this.getEventCode() == null) &amp;&amp; (toCheck.getEventCode() != null)) {
            return false;
        } else if ((this.getEventCode() != null) &amp;&amp; (!this.getEventCode().equals(toCheck.getEventCode()))) {
            return false;
        }

        if ((this.getEventCodeScheme() == null) &amp;&amp; (toCheck.getEventCodeScheme() != null)) {
            return false;
        } else if ((this.getEventCodeScheme() != null)
                &amp;&amp; (!this.getEventCodeScheme().equals(toCheck.getEventCodeScheme()))) {
            return false;
        }</pre></div></td></tr></table><table border="0" class="table table-striped"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>gov/hhs/fha/nhinc/transform/subdisc/HL7ReceiverTransforms.java</td><td>82</td></tr><tr class="a"><td>gov/hhs/fha/nhinc/transform/subdisc/HL7SenderTransforms.java</td><td>82</td></tr><tr class="b"><td colspan='2'><div><pre>        org.setDeterminerCode(HL7Constants.RECEIVER_DETERMINER_CODE);
        II id = HL7DataTransformHelper.IIFactory(OID);
        org.getId().add(id);

        javax.xml.namespace.QName xmlqnameorg = new javax.xml.namespace.QName(&quot;urn:hl7-org:v3&quot;,
                &quot;representedOrganization&quot;);
        JAXBElement&lt;MCCIMT000200UV01Organization&gt; orgElem = new JAXBElement&lt;MCCIMT000200UV01Organization&gt;(xmlqnameorg,
                MCCIMT000200UV01Organization.class, org);
        agent.setRepresentedOrganization(orgElem);
        agent.getClassCode().add(HL7Constants.AGENT_CLASS_CODE);

        javax.xml.namespace.QName xmlqnameagent = new javax.xml.namespace.QName(&quot;urn:hl7-org:v3&quot;, &quot;asAgent&quot;);
        JAXBElement&lt;MCCIMT000200UV01Agent&gt; agentElem = new JAXBElement&lt;MCCIMT000200UV01Agent&gt;(xmlqnameagent,
                MCCIMT000200UV01Agent.class, agent);</pre></div></td></tr></table><table border="0" class="table table-striped"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>gov/hhs/fha/nhinc/transform/subdisc/HL7ReceiverTransforms.java</td><td>130</td></tr><tr class="a"><td>gov/hhs/fha/nhinc/transform/subdisc/HL7SenderTransforms.java</td><td>130</td></tr><tr class="b"><td colspan='2'><div><pre>        org.setDeterminerCode(HL7Constants.RECEIVER_DETERMINER_CODE);
        II id = HL7DataTransformHelper.IIFactory(OID);
        org.getId().add(id);

        javax.xml.namespace.QName xmlqnameorg = new javax.xml.namespace.QName(&quot;urn:hl7-org:v3&quot;,
                &quot;representedOrganization&quot;);
        JAXBElement&lt;MCCIMT000100UV01Organization&gt; orgElem = new JAXBElement&lt;MCCIMT000100UV01Organization&gt;(xmlqnameorg,
                MCCIMT000100UV01Organization.class, org);
        agent.setRepresentedOrganization(orgElem);
        agent.getClassCode().add(HL7Constants.AGENT_CLASS_CODE);

        javax.xml.namespace.QName xmlqnameagent = new javax.xml.namespace.QName(&quot;urn:hl7-org:v3&quot;, &quot;asAgent&quot;);
        JAXBElement&lt;MCCIMT000100UV01Agent&gt; agentElem = new JAXBElement&lt;MCCIMT000100UV01Agent&gt;(xmlqnameagent,
                MCCIMT000100UV01Agent.class, agent);</pre></div></td></tr></table><table border="0" class="table table-striped"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>gov/hhs/fha/nhinc/transform/subdisc/HL7ReceiverTransforms.java</td><td>178</td></tr><tr class="a"><td>gov/hhs/fha/nhinc/transform/subdisc/HL7SenderTransforms.java</td><td>178</td></tr><tr class="b"><td colspan='2'><div><pre>        org.setDeterminerCode(HL7Constants.RECEIVER_DETERMINER_CODE);
        II id = HL7DataTransformHelper.IIFactory(OID);
        org.getId().add(id);

        javax.xml.namespace.QName xmlqnameorg = new javax.xml.namespace.QName(&quot;urn:hl7-org:v3&quot;,
                &quot;representedOrganization&quot;);
        JAXBElement&lt;MCCIMT000300UV01Organization&gt; orgElem = new JAXBElement&lt;MCCIMT000300UV01Organization&gt;(xmlqnameorg,
                MCCIMT000300UV01Organization.class, org);
        agent.setRepresentedOrganization(orgElem);
        agent.getClassCode().add(HL7Constants.AGENT_CLASS_CODE);

        javax.xml.namespace.QName xmlqnameagent = new javax.xml.namespace.QName(&quot;urn:hl7-org:v3&quot;, &quot;asAgent&quot;);
        JAXBElement&lt;MCCIMT000300UV01Agent&gt; agentElem = new JAXBElement&lt;MCCIMT000300UV01Agent&gt;(xmlqnameagent,
                MCCIMT000300UV01Agent.class, agent);</pre></div></td></tr></table><table border="0" class="table table-striped"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>gov/hhs/fha/nhinc/transform/subdisc/HL7Extractors.java</td><td>239</td></tr><tr class="a"><td>gov/hhs/fha/nhinc/transform/subdisc/HL7Extractors.java</td><td>312</td></tr><tr class="b"><td colspan='2'><div><pre>        if (names.get(0).getUse().size() &gt; 0) {
            CeType nameType = new CeType();
            nameType.setCode(names.get(0).getUse().get(0));
            personName.setNameType(nameType);
        }
        // Name parts
        if (names.size() &gt; 0 &amp;&amp; names.get(0).getContent() != null) {
            List&lt;Serializable&gt; choice = names.get(0).getContent();
            Iterator&lt;Serializable&gt; iterSerialObjects = choice.iterator();

            String nameString = &quot;&quot;;
            EnExplicitFamily familyName = new EnExplicitFamily();
            EnExplicitGiven givenName = new EnExplicitGiven();</pre></div></td></tr></table><table border="0" class="table table-striped"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>gov/hhs/fha/nhinc/docrepository/DocumentProcessHelper.java</td><td>805</td></tr><tr class="a"><td>gov/hhs/fha/nhinc/docrepository/adapter/AdapterComponentDocRepositoryOrchImpl.java</td><td>1125</td></tr><tr class="b"><td colspan='2'><div><pre>        for (ClassificationType classification : classifications) {
            String classificationSchemeName = classification.getClassificationScheme();
            if (XDS_EVENT_CODE_LIST_CLASSIFICATION.equals(classificationSchemeName)) {
                log.debug(&quot;Found event code classification entry. Event code: &quot;
                        + classification.getNodeRepresentation());
                EventCode eventCode = new EventCode();
                eventCode.setDocument(doc);

                // eventCode.setEventCodeId(getChildElementLongValue(eventCodeElement, &quot;codeId&quot;));
                eventCode.setEventCode(classification.getNodeRepresentation());
                eventCode.setEventCodeScheme(extractMetadataFromSlots(classification.getSlot(), XDS_CODING_SCHEME_SLOT,
                        0));
                eventCode.setEventCodeDisplayName(classification.getName().getLocalizedString().get(0).getValue());

                eventCodes.add(eventCode);
            }

        } // for (oasis.names.tc.ebxml_regrep.xsd.rim._3.ClassificationType classification : classifications)

        doc.setEventCodes(eventCodes);
        log.debug(&quot;End extractEventCodes&quot;);
    }</pre></div></td></tr></table><table border="0" class="table table-striped"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>gov/hhs/fha/nhinc/transform/audit/NotifyTransforms.java</td><td>96</td></tr><tr class="a"><td>gov/hhs/fha/nhinc/transform/audit/UnsubscribeTransforms.java</td><td>96</td></tr><tr class="b"><td>gov/hhs/fha/nhinc/transform/audit/UnsubscribeTransforms.java</td><td>189</td></tr><tr class="a"><td colspan='2'><div><pre>        String communityName = &quot;&quot;;
        if (userInfo != null &amp;&amp; userInfo.getOrg() != null) {

            if (userInfo.getOrg().getHomeCommunityId() != null) {
                communityId = userInfo.getOrg().getHomeCommunityId();
            }
            if (userInfo.getOrg().getName() != null) {
                communityName = userInfo.getOrg().getName();
            }
        }

        AuditSourceIdentificationType auditSource = AuditDataTransformHelper.createAuditSourceIdentification(
                communityId, communityName);
        auditMsg.getAuditSourceIdentification().add(auditSource);

        /* Assign ParticipationObjectIdentification */
        ParticipantObjectIdentificationType participantObject = AuditDataTransformHelper
                .createParticipantObjectIdentification(patientId);

        // Fill in the message field with the contents of the event message
        try {
            JAXBContextHandler oHandler = new JAXBContextHandler();
            JAXBContext jc = oHandler.getJAXBContext(org.oasis_open.docs.wsn.b_2.ObjectFactory.class,</pre></div></td></tr></table><table border="0" class="table table-striped"><tr class="b"><th>File</th><th>Line</th></tr><tr class="a"><td>gov/hhs/fha/nhinc/docrepository/adapter/util/DocumentLoadUtil.java</td><td>282</td></tr><tr class="b"><td>gov/hhs/fha/nhinc/docrepository/adapter/util/DocumentLoadUtil.java</td><td>310</td></tr><tr class="a"><td colspan='2'><div><pre>		Long value = null;
		if ((element != null) &amp;&amp; (childElementName != null)) {
			if (log.isDebugEnabled()) {
				log.debug(&quot;Extracting child element '&quot; + childElementName
						+ &quot;' from '&quot; + element.getTagName() + &quot;'&quot;);
			}
			NodeList nodes = element.getElementsByTagName(childElementName);
			if ((nodes != null) &amp;&amp; (nodes.getLength() &gt; 0)) {
				Node node = nodes.item(0);
				if (node instanceof Element) {
					Element childElement = (Element) node;
					String strVal = childElement.getTextContent();
					if (strVal != null) {
						try {
							value = Long.parseLong(strVal);</pre></div></td></tr></table><table border="0" class="table table-striped"><tr class="b"><th>File</th><th>Line</th></tr><tr class="a"><td>gov/hhs/fha/nhinc/transform/audit/SubscribeTransforms.java</td><td>112</td></tr><tr class="b"><td>gov/hhs/fha/nhinc/transform/audit/UnsubscribeTransforms.java</td><td>100</td></tr><tr class="a"><td>gov/hhs/fha/nhinc/transform/audit/UnsubscribeTransforms.java</td><td>193</td></tr><tr class="b"><td colspan='2'><div><pre>        if (userInfo != null &amp;&amp; userInfo.getOrg() != null) {
            if (userInfo.getOrg().getHomeCommunityId() != null) {
                communityId = userInfo.getOrg().getHomeCommunityId();
            }
            if (userInfo.getOrg().getName() != null) {
                communityName = userInfo.getOrg().getName();
            }
        }

        AuditSourceIdentificationType auditSource = AuditDataTransformHelper.createAuditSourceIdentification(
                communityId, communityName);
        auditMsg.getAuditSourceIdentification().add(auditSource);

        /* Assign ParticipationObjectIdentification */
        ParticipantObjectIdentificationType participantObject = AuditDataTransformHelper
                .createParticipantObjectIdentification(patientId);

        // Fill in the message field with the contents of the event message
        try {
            JAXBContextHandler oHandler = new JAXBContextHandler();
            JAXBContext jc = oHandler.getJAXBContext(org.oasis_open.docs.wsn.b_2.ObjectFactory.class,</pre></div></td></tr></table><table border="0" class="table table-striped"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>gov/hhs/fha/nhinc/asyncmsgs/dao/AsyncMsgRecordDao.java</td><td>195</td></tr><tr class="a"><td>gov/hhs/fha/nhinc/asyncmsgs/dao/AsyncMsgRecordDao.java</td><td>242</td></tr><tr class="b"><td colspan='2'><div><pre>                    criteria.add(Restrictions.lt(&quot;CreationTime&quot;, timestamp));
                    asyncMsgRecs = criteria.list();
                } else {
                    log.error(&quot;Failed to obtain a session from the sessionFactory&quot;);
                }
            } else {
                log.error(&quot;Session factory was null&quot;);
            }

            if (log.isDebugEnabled()) {
                log.debug(&quot;Completed database record retrieve by timestamp. Results found: &quot;
                        + ((asyncMsgRecs == null) ? &quot;0&quot; : Integer.toString(asyncMsgRecs.size())));
            }
        } finally {
            if (sess != null) {
                try {
                    sess.close();
                } catch (Throwable t) {
                    log.error(&quot;Failed to close session: &quot; + t.getMessage(), t);
                }
            }
        }

        return asyncMsgRecs;
    }

    /**
     * Query for Creation Time less than passed timestamp and status equal to Request Receieved Acknowledged
     * [REQRCVDACK]
     *
     * @param timestamp A timestamp
     * @return matching records
     */
    public List&lt;AsyncMsgRecord&gt; queryForExpired(Date timestamp) {</pre></div></td></tr></table><table border="0" class="table table-striped"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>gov/hhs/fha/nhinc/transform/policy/PatientDiscoveryPolicyTransformHelper.java</td><td>383</td></tr><tr class="a"><td>gov/hhs/fha/nhinc/transform/policy/PatientDiscoveryPolicyTransformHelper.java</td><td>424</td></tr><tr class="b"><td colspan='2'><div><pre>        II ii = extractPatientIdentifier(event.getPRPAIN201305UV02());

        if (ii != null) {

            resource = new ResourceType();

            resource.getAttribute().add(
                    attrHelper.attributeFactory(PatientAssigningAuthorityAttributeId, Constants.DataTypeString,
                    ii.getRoot()));

            String sStrippedPatientId = PatientIdFormatUtil.parsePatientId(ii.getExtension());

            log.debug(&quot;transformSubjectAddedInToCheckPolicy: sStrippedPatientId = &quot; + sStrippedPatientId);

            resource.getAttribute().add(
                    attrHelper.attributeFactory(PatientIdAttributeId, Constants.DataTypeString, sStrippedPatientId));

            request.getResource().add(resource);

        }

        request.getResource().add(resource);

        addDebugLog(&quot;End -- PatientDiscoveryPolicyTransformHelper.getRequestType()&quot;);

        return request;

    }

    protected RequestType getRequestType(PRPAIN201306UV02 event, AssertionType assertion) {</pre></div></td></tr></table><table border="0" class="table table-striped"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>gov/hhs/fha/nhinc/transform/audit/DocumentQueryTransforms.java</td><td>105</td></tr><tr class="a"><td>gov/hhs/fha/nhinc/transform/audit/DocumentQueryTransforms.java</td><td>230</td></tr><tr class="b"><td colspan='2'><div><pre>            userInfo = message.getMessage().getAssertion().getUserInfo();
        }

        // Create Event Identification Section
        // TODO: Determine what to do with Event Code and Event Code System (either auto-generate or map in
        // AdhocQueryRequest
        CodedValueType eventId = AuditDataTransformHelper.createEventId(
                AuditDataTransformConstants.EVENT_ID_CODE_DOCQUERY,
                AuditDataTransformConstants.EVENT_ID_CODE_SYS_NAME_DOC,
                AuditDataTransformConstants.EVENT_ID_CODE_SYS_NAME_DOC,
                AuditDataTransformConstants.EVENT_ID_DISPLAY_NAME_DOCQUERY);
        CodedValueType eventTypeCode = AuditDataTransformHelper.createCodeValueType(
                AuditDataTransformConstants.EVENT_TYPE_CODE_DOCQUERY,
                AuditDataTransformConstants.EVENT_TYPE_CODE_SYS_NAME_DOCQUERY,
                AuditDataTransformConstants.EVENT_TYPE_CODE_SYS_NAME_DOCQUERY_DISPNAME,
                AuditDataTransformConstants.EVENT_TYPE_CODE_DOCQUERY_DISPNAME);

        EventIdentificationType eventIdentification = AuditDataTransformHelper.createEventIdentification(
                AuditDataTransformConstants.EVENT_ACTION_CODE_EXECUTE,
                AuditDataTransformConstants.EVENT_OUTCOME_INDICATOR_SUCCESS, eventId);
        auditMsg.setEventIdentification(eventIdentification);

        eventIdentification.getEventTypeCode().add(eventTypeCode);

        // Create Active Participant Section
        if (userInfo != null) {
            AuditMessageType.ActiveParticipant participant = AuditDataTransformHelper.createActiveParticipantFromUser(
                    userInfo, true);
            auditMsg.getActiveParticipant().add(participant);
        }</pre></div></td></tr></table><table border="0" class="table table-striped"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>gov/hhs/fha/nhinc/transform/subdisc/HL7PRPA201301Transforms.java</td><td>215</td></tr><tr class="a"><td>gov/hhs/fha/nhinc/transform/subdisc/HL7PRPA201301Transforms.java</td><td>284</td></tr><tr class="b"><td colspan='2'><div><pre>            }
        }
        if (original.getId() != null) {
            result.getId().clear();
            for (II item : original.getId()) {
                result.getId().add(item);
            }
        }
        if (original.getDataEnterer() != null) {
            result.getDataEnterer().clear();
            for (MFMIMT700711UV01DataEnterer item : original.getDataEnterer()) {
                MFMIMT700701UV01DataEnterer newItem = copyDataEnterer(item);
                result.getDataEnterer().add(newItem);
            }
        }

        PRPAMT201301UV02Patient patient;
        PRPAMT201306UV02QueryByParameter params;

        params = original.getQueryByParameter().getValue();</pre></div></td></tr></table><table border="0" class="table table-striped"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>gov/hhs/fha/nhinc/docrepository/adapter/dao/EventCodeDao.java</td><td>86</td></tr><tr class="a"><td>gov/hhs/fha/nhinc/docrepository/adapter/dao/EventCodeDao.java</td><td>125</td></tr><tr class="b"><td colspan='2'><div><pre>                    sess.saveOrUpdate(eventCode);
                } else {
                    getLogger().error(&quot;Failed to obtain a session from the sessionFactory&quot;);
                }
            } else {
                getLogger().error(&quot;Session factory was null&quot;);
            }
        } finally {
            if (trans != null) {
                try {
                    trans.commit();
                } catch (Throwable t) {
                    getLogger().error(&quot;Failed to commit transaction: &quot; + t.getMessage(), t);
                }
            }
            if (sess != null) {
                try {
                    sess.close();
                } catch (Throwable t) {
                    getLogger().error(&quot;Failed to close session: &quot; + t.getMessage(), t);
                }
            }
        }
    }

    /**
     * Delete an event code record.
     * 
     * @param eventCode EventCode record to delete.
     */
    public void delete(EventCode eventCode) {</pre></div></td></tr></table><table border="0" class="table table-striped"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>gov/hhs/fha/nhinc/transform/audit/XDRTransforms.java</td><td>151</td></tr><tr class="a"><td>gov/hhs/fha/nhinc/transform/audit/XDRTransforms.java</td><td>210</td></tr><tr class="b"><td colspan='2'><div><pre>        CodedValueType eventID = getCodedValueTypeForXDRProxy();

        EventIdentificationType oEventIdentificationType = getEventIdentificationType(eventID);
        auditMsg.setEventIdentification(oEventIdentificationType);

        ActiveParticipant participant = getActiveParticipant(assertion.getUserInfo());
        auditMsg.getActiveParticipant().add(participant);

        /* Assign ParticipationObjectIdentification */
        ParticipantObjectIdentificationType participantObject = getParticipantObjectIdentificationType(patId);
        auditMsg.getParticipantObjectIdentification().add(participantObject);

        /* Create the AuditSourceIdentifierType object */
        AuditSourceIdentificationType auditSource = getAuditSourceIdentificationType(assertion.getUserInfo());
        auditMsg.getAuditSourceIdentification().add(auditSource);

        result.setAuditMessage(auditMsg);
        result.setDirection(direction);
        result.setInterface(_interface);

        return result;
    }

    public LogEventRequestType transformRequestToAuditMsg(
            gov.hhs.fha.nhinc.common.nhinccommonentity.RespondingGatewayProvideAndRegisterDocumentSetSecuredRequestType request,</pre></div></td></tr></table><table border="0" class="table table-striped"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>gov/hhs/fha/nhinc/transform/policy/PatientDiscoveryPolicyTransformHelper.java</td><td>383</td></tr><tr class="a"><td>gov/hhs/fha/nhinc/transform/policy/PatientDiscoveryPolicyTransformHelper.java</td><td>465</td></tr><tr class="b"><td colspan='2'><div><pre>        II ii = extractPatientIdentifier(event.getPRPAIN201305UV02());

        if (ii != null) {

            resource = new ResourceType();

            resource.getAttribute().add(
                    attrHelper.attributeFactory(PatientAssigningAuthorityAttributeId, Constants.DataTypeString,
                    ii.getRoot()));

            String sStrippedPatientId = PatientIdFormatUtil.parsePatientId(ii.getExtension());

            log.debug(&quot;transformSubjectAddedInToCheckPolicy: sStrippedPatientId = &quot; + sStrippedPatientId);

            resource.getAttribute().add(
                    attrHelper.attributeFactory(PatientIdAttributeId, Constants.DataTypeString, sStrippedPatientId));

            request.getResource().add(resource);

        }

        request.getResource().add(resource);

        addDebugLog(&quot;End -- PatientDiscoveryPolicyTransformHelper.getRequestType()&quot;);

        return request;

    }

    protected RequestType getRequestType(PRPAIN201306UV02 event, AssertionType assertion) {</pre></div></td></tr></table><table border="0" class="table table-striped"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>gov/hhs/fha/nhinc/transform/policy/DocRetrieveTransformHelper.java</td><td>51</td></tr><tr class="a"><td>gov/hhs/fha/nhinc/transform/policy/NotifyTransformHelper.java</td><td>43</td></tr><tr class="b"><td colspan='2'><div><pre>    public static CheckPolicyRequestType transformDocRetrieveToCheckPolicy(DocRetrieveEventType event) {
        CheckPolicyRequestType genericPolicyRequest = new CheckPolicyRequestType();
        // TODO: Need to handle DocumentSet
        // DocRetrieveMessageType docRetrieve = event.getMessage();
        RequestType request = new RequestType();

        if (InboundOutboundChecker.IsInbound(event.getDirection())) {
            request.setAction(ActionHelper.actionFactory(ActionInValue));
        }
        if (InboundOutboundChecker.IsOutbound(event.getDirection())) {
            request.setAction(ActionHelper.actionFactory(ActionOutValue));
        }

        SubjectHelper subjHelp = new SubjectHelper();
        SubjectType subject = subjHelp.subjectFactory(event.getSendingHomeCommunity(), event.getMessage()
                .getAssertion());
        request.getSubject().add(subject);</pre></div></td></tr></table><table border="0" class="table table-striped"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>gov/hhs/fha/nhinc/transform/subdisc/HL7PatientTransforms.java</td><td>649</td></tr><tr class="a"><td>gov/hhs/fha/nhinc/transform/subdisc/HL7PatientTransforms.java</td><td>789</td></tr><tr class="b"><td colspan='2'><div><pre>        if (birthPlace.getBirthplace() != null) {
            result.setBirthplace(birthPlace.getBirthplace());
        }
        if (NullChecker.isNotNullish(birthPlace.getClassCode())) {
            for (String code : birthPlace.getClassCode()) {
                result.getClassCode().add(code);
            }
        }
        javax.xml.namespace.QName xmlqname = new javax.xml.namespace.QName(&quot;urn:hl7-org:v3&quot;, &quot;birthPlace&quot;);
        JAXBElement&lt;PRPAMT201301UV02BirthPlace&gt; element = new JAXBElement&lt;PRPAMT201301UV02BirthPlace&gt;(xmlqname,
                PRPAMT201301UV02BirthPlace.class, result);

        return element;
    }

    public static JAXBElement&lt;PRPAMT201301UV02Person&gt; create201301PatientPerson(PRPAMT201310UV02Person person) {</pre></div></td></tr></table><table border="0" class="table table-striped"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>gov/hhs/fha/nhinc/asyncmsgs/dao/AsyncMsgRecordDao.java</td><td>517</td></tr><tr class="a"><td>gov/hhs/fha/nhinc/asyncmsgs/dao/AsyncMsgRecordDao.java</td><td>614</td></tr><tr class="b"><td colspan='2'><div><pre>                    sess.saveOrUpdate(asyncMsgRecord);
                } else {
                    log.error(&quot;Failed to obtain a session from the sessionFactory&quot;);
                }
            } else {
                log.error(&quot;Session factory was null&quot;);
            }
        } finally {
            if (trans != null) {
                try {
                    trans.commit();
                } catch (Throwable t) {
                    log.error(&quot;Failed to commit transaction: &quot; + t.getMessage(), t);
                }
            }
            if (sess != null) {
                try {
                    sess.close();
                } catch (Throwable t) {
                    log.error(&quot;Failed to close session: &quot; + t.getMessage(), t);
                }
            }
        }

        log.debug(&quot;AsyncMsgRecordDao.save() - End&quot;);</pre></div></td></tr></table><table border="0" class="table table-striped"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>gov/hhs/fha/nhinc/docrepository/adapter/dao/DocumentDao.java</td><td>70</td></tr><tr class="a"><td>gov/hhs/fha/nhinc/docrepository/adapter/dao/DocumentDao.java</td><td>113</td></tr><tr class="b"><td colspan='2'><div><pre>                    sess.saveOrUpdate(document);
                } else {
                    log.error(&quot;Failed to obtain a session from the sessionFactory&quot;);
                }
            } else {
                log.error(&quot;Session factory was null&quot;);
            }
        } finally {
            if (trans != null) {
                try {
                    trans.commit();
                } catch (Throwable t) {
                    log.error(&quot;Failed to commit transaction: &quot; + t.getMessage(), t);
                }
            }
            if (sess != null) {
                try {
                    sess.close();
                } catch (Throwable t) {
                    log.error(&quot;Failed to close session: &quot; + t.getMessage(), t);
                }
            }
        }

        log.debug(&quot;Completed document save&quot;);</pre></div></td></tr></table><table border="0" class="table table-striped"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>gov/hhs/fha/nhinc/asyncmsgs/dao/AsyncMsgRecordDao.java</td><td>517</td></tr><tr class="a"><td>gov/hhs/fha/nhinc/asyncmsgs/dao/AsyncMsgRecordDao.java</td><td>571</td></tr><tr class="b"><td>gov/hhs/fha/nhinc/asyncmsgs/dao/AsyncMsgRecordDao.java</td><td>614</td></tr><tr class="a"><td>gov/hhs/fha/nhinc/docrepository/adapter/dao/DocumentDao.java</td><td>70</td></tr><tr class="b"><td>gov/hhs/fha/nhinc/docrepository/adapter/dao/DocumentDao.java</td><td>113</td></tr><tr class="a"><td colspan='2'><div><pre>                    sess.saveOrUpdate(asyncMsgRecord);
                } else {
                    log.error(&quot;Failed to obtain a session from the sessionFactory&quot;);
                }
            } else {
                log.error(&quot;Session factory was null&quot;);
            }
        } finally {
            if (trans != null) {
                try {
                    trans.commit();
                } catch (Throwable t) {
                    log.error(&quot;Failed to commit transaction: &quot; + t.getMessage(), t);
                }
            }
            if (sess != null) {
                try {
                    sess.close();
                } catch (Throwable t) {
                    log.error(&quot;Failed to close session: &quot; + t.getMessage(), t);
                }
            }
        }

        log.debug(&quot;AsyncMsgRecordDao.save() - End&quot;);</pre></div></td></tr></table><table border="0" class="table table-striped"><tr class="b"><th>File</th><th>Line</th></tr><tr class="a"><td>gov/hhs/fha/nhinc/transform/subdisc/HL7Extractors.java</td><td>281</td></tr><tr class="b"><td>gov/hhs/fha/nhinc/transform/subdisc/HL7Extractors.java</td><td>350</td></tr><tr class="a"><td colspan='2'><div><pre>            if (nameString != null &amp;&amp; hasName == false) {
                log.debug(&quot;set org name text &quot;);
                personName.setFamilyName(nameString);
            } else {
                if (givenName.getContent() != null &amp;&amp; givenName.getContent().length() &gt; 0) {
                    log.debug(&quot;set org name given &quot;);
                    personName.setGivenName(givenName.getContent());

                }
                if (familyName.getContent() != null &amp;&amp; familyName.getContent().length() &gt; 0) {
                    log.debug(&quot;set org name family &quot;);
                    personName.setFamilyName(familyName.getContent());
                }

            }
        }
        log.debug(&quot;HL7Extractor.translatePNListtoPersonNameType() -- End&quot;);</pre></div></td></tr></table><table border="0" class="table table-striped"><tr class="b"><th>File</th><th>Line</th></tr><tr class="a"><td>gov/hhs/fha/nhinc/transform/subdisc/HL7PRPA201302Transforms.java</td><td>140</td></tr><tr class="b"><td>gov/hhs/fha/nhinc/transform/subdisc/HL7PRPA201302Transforms.java</td><td>160</td></tr><tr class="a"><td colspan='2'><div><pre>            PRPAMT201301UV02Patient patient, String remotePatId, String remoteDeviceId) {
        PRPAIN201302UV02MFMIMT700701UV01RegistrationEvent regevent = new PRPAIN201302UV02MFMIMT700701UV01RegistrationEvent();

        regevent.getClassCode().add(&quot;REG&quot;);
        regevent.getMoodCode().add(&quot;EVN&quot;);

        II regId = new II();
        regId.getNullFlavor().add(&quot;NA&quot;);
        regevent.getId().add(regId);

        regevent.setStatusCode(HL7DataTransformHelper.CSFactory(&quot;active&quot;));

        regevent.setSubject1(createPRPAIN201302UVMFMIMT700701UV01Subject2(patient, remotePatId, remoteDeviceId));

        regevent.setCustodian(HL7CustodianTransforms.createMFMIMT700701UV01Custodian(localDeviceId));

        return regevent;
    }

    public static PRPAIN201302UV02MFMIMT700701UV01RegistrationEvent createPRPAIN201302UVMFMIMT700701UV01RegistrationEvent(</pre></div></td></tr></table><table border="0" class="table table-striped"><tr class="b"><th>File</th><th>Line</th></tr><tr class="a"><td>gov/hhs/fha/nhinc/docrepository/DocumentProcessHelper.java</td><td>298</td></tr><tr class="b"><td>gov/hhs/fha/nhinc/docrepository/adapter/AdapterComponentDocRepositoryOrchImpl.java</td><td>456</td></tr><tr class="a"><td colspan='2'><div><pre>            for (int i = 0; i &lt; identifiableObjectList.size(); i++) {
                oasis.names.tc.ebxml_regrep.xsd.rim._3.ExtrinsicObjectType extrinsicObject = null;
                log.debug(&quot;Item &quot; + i + &quot; identifiableObject is of DeclaredType: &quot;
                        + identifiableObjectList.get(i).getDeclaredType());

                // the getValue method will return the non-JAXBElement&lt;? extends...&gt; object
                Object tempObj = identifiableObjectList.get(i).getValue();
                if (tempObj instanceof oasis.names.tc.ebxml_regrep.xsd.rim._3.ExtrinsicObjectType) {
                    extrinsicObject = (ExtrinsicObjectType) tempObj;
                    log.debug(&quot;extrinsicObject successfully populated&quot;);</pre></div></td></tr></table><table border="0" class="table table-striped"><tr class="b"><th>File</th><th>Line</th></tr><tr class="a"><td>gov/hhs/fha/nhinc/callback/SamlConstants.java</td><td>86</td></tr><tr class="b"><td>gov/hhs/fha/nhinc/nhinclib/NhincConstants.java</td><td>204</td></tr><tr class="a"><td colspan='2'><div><pre>    public static final String PAT_CORR_ACTION = &quot;patientcorrelation&quot;;
    public static final String ADAPTER_MPI_ACTION = &quot;mpi&quot;;
    public static final String XDR_ACTION = &quot;xdr&quot;;
    public static final String XDR_REQUEST_ACTION = &quot;xdrrequest&quot;;
    public static final String XDR_RESPONSE_ACTION = &quot;xdrresponse&quot;;
    public static final String USERNAME_ATTR = &quot;urn:oasis:names:tc:xspa:1.0:subject:subject-id&quot;;
    public static final String USER_ORG_ATTR = &quot;urn:oasis:names:tc:xspa:1.0:subject:organization&quot;;
    public static final String USER_ORG_ID_ATTR = &quot;urn:oasis:names:tc:xspa:1.0:subject:organization-id&quot;;
    public static final String HOME_COM_ID_ATTR = &quot;urn:nhin:names:saml:homeCommunityId&quot;;
    public static final String USER_ROLE_ATTR = &quot;urn:oasis:names:tc:xacml:2.0:subject:role&quot;;
    public static final String PURPOSE_ROLE_ATTR = &quot;urn:oasis:names:tc:xspa:1.0:subject:purposeofuse&quot;;
    public static final String PATIENT_ID_ATTR = &quot;urn:oasis:names:tc:xacml:2.0:resource:resource-id&quot;;
    public static final String ACCESS_CONSENT_ATTR = &quot;AccessConsentPolicy&quot;;
    public static final String INST_ACCESS_CONSENT_ATTR = &quot;InstanceAccessConsentPolicy&quot;;
    public static final String CE_CODE_ID = &quot;code&quot;;</pre></div></td></tr></table><table border="0" class="table table-striped"><tr class="b"><th>File</th><th>Line</th></tr><tr class="a"><td>gov/hhs/fha/nhinc/asyncmsgs/dao/AsyncMsgRecordDao.java</td><td>518</td></tr><tr class="b"><td>gov/hhs/fha/nhinc/asyncmsgs/dao/AsyncMsgRecordDao.java</td><td>572</td></tr><tr class="a"><td>gov/hhs/fha/nhinc/asyncmsgs/dao/AsyncMsgRecordDao.java</td><td>615</td></tr><tr class="b"><td>gov/hhs/fha/nhinc/docrepository/adapter/dao/DocumentDao.java</td><td>71</td></tr><tr class="a"><td>gov/hhs/fha/nhinc/docrepository/adapter/dao/DocumentDao.java</td><td>114</td></tr><tr class="b"><td>gov/hhs/fha/nhinc/patientcorrelation/nhinc/dao/PDDeferredCorrelationDao.java</td><td>167</td></tr><tr class="a"><td colspan='2'><div><pre>                } else {
                    log.error(&quot;Failed to obtain a session from the sessionFactory&quot;);
                }
            } else {
                log.error(&quot;Session factory was null&quot;);
            }
        } finally {
            if (trans != null) {
                try {
                    trans.commit();
                } catch (Throwable t) {
                    log.error(&quot;Failed to commit transaction: &quot; + t.getMessage(), t);
                }
            }
            if (sess != null) {
                try {
                    sess.close();
                } catch (Throwable t) {
                    log.error(&quot;Failed to close session: &quot; + t.getMessage(), t);
                }
            }
        }

        log.debug(&quot;AsyncMsgRecordDao.save() - End&quot;);</pre></div></td></tr></table><table border="0" class="table table-striped"><tr class="b"><th>File</th><th>Line</th></tr><tr class="a"><td>gov/hhs/fha/nhinc/transform/audit/NotifyTransforms.java</td><td>187</td></tr><tr class="b"><td>gov/hhs/fha/nhinc/transform/audit/UnsubscribeTransforms.java</td><td>96</td></tr><tr class="a"><td>gov/hhs/fha/nhinc/transform/audit/UnsubscribeTransforms.java</td><td>189</td></tr><tr class="b"><td colspan='2'><div><pre>        String communityName = &quot;&quot;;
        if (userInfo != null &amp;&amp; userInfo.getOrg() != null) {

            if (userInfo.getOrg().getHomeCommunityId() != null) {
                communityId = userInfo.getOrg().getHomeCommunityId();
            }
            if (userInfo.getOrg().getName() != null) {
                communityName = userInfo.getOrg().getName();
            }
        }

        AuditSourceIdentificationType auditSource = AuditDataTransformHelper.createAuditSourceIdentification(
                communityId, communityName);
        auditMsg.getAuditSourceIdentification().add(auditSource);

        /* Assign ParticipationObjectIdentification */
        ParticipantObjectIdentificationType participantObject = AuditDataTransformHelper
                .createParticipantObjectIdentification(patientId);</pre></div></td></tr></table><table border="0" class="table table-striped"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>gov/hhs/fha/nhinc/patientcorrelation/nhinc/parsers/PRPAIN201301UV/PRPAIN201301UVParser.java</td><td>97</td></tr><tr class="a"><td>gov/hhs/fha/nhinc/transform/subdisc/HL7Extractors.java</td><td>48</td></tr><tr class="b"><td colspan='2'><div><pre>    public static PRPAIN201301UV02MFMIMT700701UV01Subject1 ParseSubjectFromMessage(org.hl7.v3.PRPAIN201301UV02 message) {
        // assume one subject for now

        if (message == null) {
            log.info(&quot;message is null - no patient&quot;);
            return null;
        }
        PRPAIN201301UV02MFMIMT700701UV01ControlActProcess controlActProcess = message.getControlActProcess();
        if (controlActProcess == null) {
            log.info(&quot;controlActProcess is null - no patient&quot;);
            return null;
        }
        // HL7Parser.PrintId(controlActProcess.getId(), &quot;controlActProcess&quot;);

        List&lt;PRPAIN201301UV02MFMIMT700701UV01Subject1&gt; subjects = controlActProcess.getSubject();
        if ((subjects == null) || (subjects.size() == 0)) {
            log.info(&quot;subjects is blank/null - no patient&quot;);
            return null;
        }

        // for now, assume we only need one subject, this will need to be modified later
        PRPAIN201301UV02MFMIMT700701UV01Subject1 subject = subjects.get(0);
        // HL7Parser.PrintId(subject.getTypeId(), &quot;subject&quot;);

        return subject;
    }</pre></div></td></tr></table><table border="0" class="table table-striped"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>gov/hhs/fha/nhinc/transform/subdisc/HL7ArrayTransforms.java</td><td>304</td></tr><tr class="a"><td>gov/hhs/fha/nhinc/transform/subdisc/HL7ReceiverTransforms.java</td><td>134</td></tr><tr class="b"><td>gov/hhs/fha/nhinc/transform/subdisc/HL7SenderTransforms.java</td><td>134</td></tr><tr class="a"><td colspan='2'><div><pre>            javax.xml.namespace.QName xmlqnameorg = new javax.xml.namespace.QName(&quot;urn:hl7-org:v3&quot;,
                    &quot;representedOrganization&quot;);
            JAXBElement&lt;MCCIMT000100UV01Organization&gt; orgElem = new JAXBElement&lt;MCCIMT000100UV01Organization&gt;(
                    xmlqnameorg, MCCIMT000100UV01Organization.class, org);
            agent.setRepresentedOrganization(orgElem);
            agent.getClassCode().add(HL7Constants.AGENT_CLASS_CODE);

            javax.xml.namespace.QName xmlqnameagent = new javax.xml.namespace.QName(&quot;urn:hl7-org:v3&quot;, &quot;asAgent&quot;);
            JAXBElement&lt;MCCIMT000100UV01Agent&gt; agentElem = new JAXBElement&lt;MCCIMT000100UV01Agent&gt;(xmlqnameagent,
                    MCCIMT000100UV01Agent.class, agent);</pre></div></td></tr></table><table border="0" class="table table-striped"><tr class="b"><th>File</th><th>Line</th></tr><tr class="a"><td>gov/hhs/fha/nhinc/asyncmsgs/persistence/HibernateUtil.java</td><td>43</td></tr><tr class="b"><td>gov/hhs/fha/nhinc/docrepository/adapter/persistence/HibernateUtil.java</td><td>42</td></tr><tr class="a"><td>gov/hhs/fha/nhinc/patientcorrelation/nhinc/persistence/HibernateUtil.java</td><td>42</td></tr><tr class="b"><td>gov/hhs/fha/nhinc/perfrepo/persistance/HibernateUtil.java</td><td>41</td></tr><tr class="a"><td colspan='2'><div><pre>public class HibernateUtil {
    private static final SessionFactory sessionFactory;
    private static Log log = LogFactory.getLog(HibernateUtil.class);
    static {
        try {
            // Create the SessionFactory from hibernate.cfg.xml
            sessionFactory = new Configuration().configure(getConfigFile()).buildSessionFactory();
        } catch (Throwable ex) {
            // Make sure you log the exception, as it might be swallowed
            log.error(&quot;Initial SessionFactory creation failed.&quot; + ex);
            throw new ExceptionInInitializerError(ex);
        }
    }

    /**
     * Method returns an instance of Hibernate SessionFactory.
     *
     * @return SessionFactory
     */
    public static SessionFactory getSessionFactory() {
        return sessionFactory;
    }

    private static File getConfigFile() {
        File result = null;

        try {
            result = HibernateAccessor.getInstance().getHibernateFile(NhincConstants.HIBERNATE_ASYNCMSGS_REPOSITORY);</pre></div></td></tr></table><table border="0" class="table table-striped"><tr class="b"><th>File</th><th>Line</th></tr><tr class="a"><td>gov/hhs/fha/nhinc/transform/audit/NotifyTransforms.java</td><td>92</td></tr><tr class="b"><td>gov/hhs/fha/nhinc/transform/audit/NotifyTransforms.java</td><td>183</td></tr><tr class="a"><td>gov/hhs/fha/nhinc/transform/audit/SubscribeTransforms.java</td><td>189</td></tr><tr class="b"><td colspan='2'><div><pre>            patientId = message.getMessage().getAssertion().getUniquePatientId().get(0);
        }

        String communityId = &quot;&quot;;
        String communityName = &quot;&quot;;
        if (userInfo != null &amp;&amp; userInfo.getOrg() != null) {

            if (userInfo.getOrg().getHomeCommunityId() != null) {
                communityId = userInfo.getOrg().getHomeCommunityId();
            }
            if (userInfo.getOrg().getName() != null) {
                communityName = userInfo.getOrg().getName();
            }
        }

        AuditSourceIdentificationType auditSource = AuditDataTransformHelper.createAuditSourceIdentification(
                communityId, communityName);
        auditMsg.getAuditSourceIdentification().add(auditSource);</pre></div></td></tr></table><table border="0" class="table table-striped"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>gov/hhs/fha/nhinc/transform/policy/DocRetrieveTransformHelper.java</td><td>52</td></tr><tr class="a"><td>gov/hhs/fha/nhinc/transform/policy/NotifyTransformHelper.java</td><td>44</td></tr><tr class="b"><td>gov/hhs/fha/nhinc/transform/policy/SubscribeTransformHelper.java</td><td>66</td></tr><tr class="a"><td colspan='2'><div><pre>        CheckPolicyRequestType genericPolicyRequest = new CheckPolicyRequestType();
        // TODO: Need to handle DocumentSet
        // DocRetrieveMessageType docRetrieve = event.getMessage();
        RequestType request = new RequestType();

        if (InboundOutboundChecker.IsInbound(event.getDirection())) {
            request.setAction(ActionHelper.actionFactory(ActionInValue));
        }
        if (InboundOutboundChecker.IsOutbound(event.getDirection())) {
            request.setAction(ActionHelper.actionFactory(ActionOutValue));
        }

        SubjectHelper subjHelp = new SubjectHelper();
        SubjectType subject = subjHelp.subjectFactory(event.getSendingHomeCommunity(), event.getMessage()
                .getAssertion());
        request.getSubject().add(subject);</pre></div></td></tr></table><table border="0" class="table table-striped"><tr class="b"><th>File</th><th>Line</th></tr><tr class="a"><td>gov/hhs/fha/nhinc/transform/audit/NotifyTransforms.java</td><td>188</td></tr><tr class="b"><td>gov/hhs/fha/nhinc/transform/audit/SubscribeTransforms.java</td><td>112</td></tr><tr class="a"><td colspan='2'><div><pre>        if (userInfo != null &amp;&amp; userInfo.getOrg() != null) {

            if (userInfo.getOrg().getHomeCommunityId() != null) {
                communityId = userInfo.getOrg().getHomeCommunityId();
            }
            if (userInfo.getOrg().getName() != null) {
                communityName = userInfo.getOrg().getName();
            }
        }

        AuditSourceIdentificationType auditSource = AuditDataTransformHelper.createAuditSourceIdentification(
                communityId, communityName);
        auditMsg.getAuditSourceIdentification().add(auditSource);

        /* Assign ParticipationObjectIdentification */
        ParticipantObjectIdentificationType participantObject = AuditDataTransformHelper
                .createParticipantObjectIdentification(patientId);</pre></div></td></tr></table></div>
                  </div>
            </div>
          </div>

    <hr/>

    <footer>
            <div class="container-fluid">
              <div class="row span12">Copyright &copy;                   2012.
          All Rights Reserved.      
            
      </div>

        
        
                </div>
    </footer>
  </body>
</html>
